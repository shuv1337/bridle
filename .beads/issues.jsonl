{"id":"bridle-0c2","title":"harness-locate returns opencode.json but file is opencode.jsonc","description":"harness-locate's mcp() for OpenCode returns 'opencode.json' as the filename, but OpenCode actually uses 'opencode.jsonc'. This causes file-not-found when looking for the config.\n\nDiscovered while investigating bridle-979.\n\nRelated: bridle-979","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-29T20:23:47.595198Z","updated_at":"2025-12-29T20:54:38.576134Z","closed_at":"2025-12-29T20:54:38.576134Z","close_reason":"Documented as harness-locate bug - returns opencode.json but file is opencode.jsonc. See harness-locate-bugs.md Issue 5"}
{"id":"bridle-0sp","title":"Fix test isolation: tests share global BridleConfig","description":"Tests switch_profile_preserves_edits and switch_profile_restores_mcp_config use same harness ID 'test-harness' and share global BridleConfig at ~/.config/bridle/config.yaml. When run in parallel, they race to set/read active_profile, causing flaky failures. Fix: give each test a unique harness ID or mock BridleConfig.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-29T14:55:48.723418Z","updated_at":"2025-12-29T20:52:01.330123Z","closed_at":"2025-12-29T20:52:01.330123Z","close_reason":"Fixed by giving each test a unique harness ID (test-preserves-edits, test-copies-mcp, test-restores-mcp)"}
{"id":"bridle-1ps","title":"Claude Code profile create --from-current doesn't copy settings.json","description":"When creating a Claude Code profile with --from-current, only history.jsonl and stats-cache.json are copied. The actual config files (settings.json, .mcp.json) are not copied because Claude stores them at ~/.claude/ or ~/.claude.json, not in the harness config directory.\n\n## Verification Steps\n\n1. Delete and recreate test profile:\n   ```bash\n   cargo run -- profile delete claude test\n   cargo run -- profile create claude test --from-current\n   ```\n\n2. Check what was copied:\n   ```bash\n   ls -la ~/.config/bridle/profiles/claude-code/test/\n   ```\n\n3. **Before fix**: Only shows history.jsonl, stats-cache.json (no settings.json)\n\n4. **After fix**: Should also copy:\n   - settings.json (from ~/.claude/settings.json or ~/.claude.json)\n   - .mcp.json (if exists at ~/.claude/.mcp.json)\n\n5. Verify profile show works:\n   ```bash\n   cargo run -- profile show claude test\n   ```\n   \n   **After fix**: Model should show configured value (if user has one set)\n\n## Notes\n- Claude Code config locations: ~/.claude/settings.json, ~/.claude.json, .mcp.json\n- May need to handle case where user has no settings.json (new Claude install)","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-28T14:37:31.917867Z","updated_at":"2025-12-28T15:13:05.687524Z","closed_at":"2025-12-28T15:13:05.687524Z","close_reason":"Fixed - MCP config files now copied during all profile operations"}
{"id":"bridle-1ps.1","title":"Add copy_config_files helper function","description":"## Context\nCreate helper function that encapsulates config file copying logic for all profile operations.\n\n## Key Changes\n- `src/config/manager.rs` - Add `copy_config_files(harness, source_is_live, profile_path)` function\n- Handles files from config_dir() AND mcp(\u0026Scope::Global)\n- Tracks copied files to avoid duplicates\n- Supports bidirectional copying (live→profile and profile→live)\n\n## Patterns to Follow\n- Use existing Result\u003c()\u003e error handling pattern\n- Match existing file iteration style in manager.rs\n\n## Success Criteria\n- [ ] cargo check passes\n- [ ] cargo clippy -- -D warnings passes\n- [ ] Function handles both copy directions\n\n## References\n- Full plan: `.beads/artifacts/bridle-1ps/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T15:03:23.845105Z","updated_at":"2025-12-28T15:40:08.318211Z","closed_at":"2025-12-28T15:40:08.318211Z","close_reason":"Work completed in prior session - copy_config_files helper implemented and tested","dependencies":[{"issue_id":"bridle-1ps.1","depends_on_id":"bridle-1ps","type":"parent-child","created_at":"2025-12-28T15:03:23.845785Z","created_by":"daemon"}]}
{"id":"bridle-1ps.2","title":"Update create_from_current to use helper","description":"## Context\nReplace inline copy loop in create_from_current with helper call.\n\n## Key Changes\n- `src/config/manager.rs:208-229` - Replace loop with copy_config_files(harness, true, \u0026profile_path)\n\n## Success Criteria\n- [ ] cargo test passes\n- [ ] Existing test switch_profile_preserves_edits still passes\n\n## References\n- Full plan: `.beads/artifacts/bridle-1ps/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T15:03:27.227931Z","updated_at":"2025-12-28T15:40:08.319601Z","closed_at":"2025-12-28T15:40:08.319601Z","close_reason":"Work completed in prior session - copy_config_files helper implemented and tested","dependencies":[{"issue_id":"bridle-1ps.2","depends_on_id":"bridle-1ps","type":"parent-child","created_at":"2025-12-28T15:03:27.230204Z","created_by":"daemon"}]}
{"id":"bridle-1ps.3","title":"Update backup_current to use helper","description":"## Context\nReplace inline copy loop in backup_current with helper call.\n\n## Key Changes\n- `src/config/manager.rs:671-695` - Replace loop with copy_config_files call\n\n## Success Criteria\n- [ ] cargo test passes\n\n## References\n- Full plan: `.beads/artifacts/bridle-1ps/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T15:03:29.51289Z","updated_at":"2025-12-28T15:40:08.320646Z","closed_at":"2025-12-28T15:40:08.320646Z","close_reason":"Work completed in prior session - copy_config_files helper implemented and tested","dependencies":[{"issue_id":"bridle-1ps.3","depends_on_id":"bridle-1ps","type":"parent-child","created_at":"2025-12-28T15:03:29.515165Z","created_by":"daemon"}]}
{"id":"bridle-1ps.4","title":"Update save_to_profile and switch_profile","description":"## Context\nUpdate remaining two methods to use helper for consistent MCP handling.\n\n## Key Changes\n- `src/config/manager.rs:697-724` - Update save_to_profile\n- `src/config/manager.rs:726-772` - Update switch_profile (both directions)\n\n## Success Criteria\n- [ ] cargo test passes\n- [ ] Profile switch correctly restores MCP config\n\n## References\n- Full plan: `.beads/artifacts/bridle-1ps/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T15:03:32.45072Z","updated_at":"2025-12-28T15:40:08.321706Z","closed_at":"2025-12-28T15:40:08.321706Z","close_reason":"Work completed in prior session - copy_config_files helper implemented and tested","dependencies":[{"issue_id":"bridle-1ps.4","depends_on_id":"bridle-1ps","type":"parent-child","created_at":"2025-12-28T15:03:32.452962Z","created_by":"daemon"}]}
{"id":"bridle-1ps.5","title":"Add tests for MCP config handling","description":"## Context\nAdd tests verifying MCP config is properly copied during profile operations.\n\n## Key Changes\n- Add MockHarness mcp() method\n- Add create_from_current_copies_mcp_config test\n- Add switch_profile_restores_mcp_config test\n\n## Success Criteria\n- [ ] New tests pass\n- [ ] cargo test all green\n\n## References\n- Full plan: `.beads/artifacts/bridle-1ps/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T15:03:34.345453Z","updated_at":"2025-12-28T15:40:08.322869Z","closed_at":"2025-12-28T15:40:08.322869Z","close_reason":"Work completed in prior session - copy_config_files helper implemented and tested","dependencies":[{"issue_id":"bridle-1ps.5","depends_on_id":"bridle-1ps","type":"parent-child","created_at":"2025-12-28T15:03:34.347684Z","created_by":"daemon"}]}
{"id":"bridle-223","title":"AMP Code theme field not parsed","description":"## Problem\nAMP Code theme shows '(not supported)' even when configured.\n\n## Evidence\nConfig has `\"amp.theme\": \"dark\"` but parser shows not supported.\n\n## Preliminary Analysis\n`extract_theme()` explicitly returns `None` for amp-code harness - implementation is missing.\n\n## Research Required\n**Agent must verify**: Is this a bridle logic bug (missing implementation) or does AMP Code not actually support a theme setting?\n\nCheck:\n1. Does official AMP Code documentation confirm theme is a valid setting?\n2. What's the correct key name (`amp.theme` vs something else)?\n3. Is `harness-locate` involved in theme extraction?\n\n## Test Command\n```bash\ncargo run -- profile show amp-code full-test\n```","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-29T18:22:56.813809Z","updated_at":"2025-12-29T20:53:55.944991Z","closed_at":"2025-12-29T20:53:55.944991Z","close_reason":"Already working - amp-code theme parsing correctly reads amp.theme from settings.json. Verified with test profile."}
{"id":"bridle-2q5","title":"Fix: active profiles show resources from global dir, TUI preserves resources on switch","description":"Two bugs fixed: (1) show_profile looked in profile dir for resources even when profile was active - now looks in global harness config dir. (2) TUI used switch_profile which passed None for harness_for_resources, causing resource dirs to be deleted during switch - now uses switch_profile_with_resources.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-30T00:17:58.117593Z","updated_at":"2025-12-30T00:18:19.559948Z","closed_at":"2025-12-30T00:18:19.559948Z","close_reason":"Fixed both issues: show_profile now looks in global dir for active profiles, TUI preserves resources on switch"}
{"id":"bridle-2z6","title":"Implement recursive directory copy for profile resources","description":"## Context\nDepends on bridle-b1h analysis. This task implements the fix.\n\n## Implementation Plan\n\n### Step 1: Add directory copy helper\nAdd a helper function to recursively copy directories:\n```rust\nfn copy_dir_recursive(src: \u0026Path, dst: \u0026Path) -\u003e Result\u003c()\u003e\n```\n\n### Step 2: Modify copy_config_files\nIn `copy_config_files` when `source_is_live=true`:\n1. Query harness for resource directory names: `harness.agents()`, `harness.commands()`, `harness.skills()`\n2. For each resource type, if directory exists in source, copy it recursively to profile\n\n### Step 3: Verify TUI/CLI parity\nBoth use same `ProfileInfo` from `show_profile()`, so fixing the data fixes both. Verify:\n- `cargo run -- profile show opencode maestro` shows resources\n- `cargo run -- tui` → select maestro → shows same resources\n\n### Step 4: Handle edge cases\n- Symlinks in resource directories\n- Empty directories\n- Profile update (`--from-current` on existing profile) should replace directories\n\n## Test Plan\n```bash\n# Delete and recreate test profile\ncargo run -- profile delete opencode test\ncargo run -- profile create opencode test --from-current\n\n# Verify CLI\ncargo run -- profile show opencode test\n\n# Verify TUI\ncargo run -- tui\n```\n\n## Files to modify\n- `src/config/manager.rs`: copy_config_files function (~line 240)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T14:14:14.375557Z","updated_at":"2025-12-29T15:14:21.837231Z","closed_at":"2025-12-29T15:14:21.837231Z","close_reason":"Implemented recursive directory copy for profile resources - all tests passing","dependencies":[{"issue_id":"bridle-2z6","depends_on_id":"bridle-b1h","type":"blocks","created_at":"2025-12-29T14:14:19.902595Z","created_by":"daemon"}]}
{"id":"bridle-3do","title":"Create OutputFormat enum and output module","description":"## Parent Epic\nbridle-xgw: Nushell-friendly structured output for CLI display commands\n\n## Objective\nCreate the core output abstraction module with format enum, shell detection, and output helpers.\n\n## New File: src/cli/output.rs\n\n```rust\n//! Structured output support for CLI commands.\n//!\n//! Provides format selection (text/json/auto) with automatic Nushell detection.\n\nuse clap::ValueEnum;\nuse serde::Serialize;\n\n/// Output format for CLI commands.\n#[derive(Debug, Clone, Copy, Default, ValueEnum)]\npub enum OutputFormat {\n    /// Human-readable text output\n    Text,\n    /// JSON output for scripting and piping\n    Json,\n    /// Auto-detect: JSON in Nushell, text otherwise\n    #[default]\n    Auto,\n}\n\n/// Resolved output format after auto-detection.\n#[derive(Debug, Clone, Copy, PartialEq, Eq)]\npub enum ResolvedFormat {\n    Text,\n    Json,\n}\n\nimpl OutputFormat {\n    /// Resolve auto format based on shell detection.\n    pub fn resolve(self) -\u003e ResolvedFormat {\n        match self {\n            Self::Text =\u003e ResolvedFormat::Text,\n            Self::Json =\u003e ResolvedFormat::Json,\n            Self::Auto =\u003e {\n                if is_nushell() {\n                    ResolvedFormat::Json\n                } else {\n                    ResolvedFormat::Text\n                }\n            }\n        }\n    }\n}\n\n/// Detect if running inside Nushell.\n///\n/// Checks for the `NU_VERSION` environment variable which Nushell sets.\nfn is_nushell() -\u003e bool {\n    std::env::var(\"NU_VERSION\").is_ok()\n}\n\n/// Output data in the specified format.\n///\n/// For JSON format, serializes to compact JSON.\n/// For text format, calls the provided text formatting function.\npub fn output\u003cT, F\u003e(data: \u0026T, format: ResolvedFormat, text_fn: F)\nwhere\n    T: Serialize,\n    F: FnOnce(\u0026T),\n{\n    match format {\n        ResolvedFormat::Json =\u003e {\n            // Use compact JSON for easy piping\n            println!(\"{}\", serde_json::to_string(data).expect(\"serialization should not fail\"));\n        }\n        ResolvedFormat::Text =\u003e {\n            text_fn(data);\n        }\n    }\n}\n\n/// Output a list of items in the specified format.\n///\n/// For JSON, outputs as a JSON array.\n/// For text, calls the provided formatting function for each item.\npub fn output_list\u003cT, F\u003e(items: \u0026[T], format: ResolvedFormat, text_fn: F)\nwhere\n    T: Serialize,\n    F: FnOnce(\u0026[T]),\n{\n    match format {\n        ResolvedFormat::Json =\u003e {\n            println!(\"{}\", serde_json::to_string(items).expect(\"serialization should not fail\"));\n        }\n        ResolvedFormat::Text =\u003e {\n            text_fn(items);\n        }\n    }\n}\n```\n\n## Update src/cli/mod.rs\n\nAdd the new module:\n```rust\npub mod output;\n// ... existing modules\n```\n\n## Design Decisions\n\n1. **ValueEnum derive**: Integrates directly with clap for `--output` flag parsing\n2. **Default = Auto**: Users get smart behavior without configuration\n3. **Two-phase resolution**: `OutputFormat` → `ResolvedFormat` separates parsing from logic\n4. **Closure for text**: Avoids trait complexity; commands provide their existing println logic\n5. **Compact JSON**: No pretty-printing; easier for piping and parsing\n\n## Verification\n```bash\ncargo check\ncargo clippy -- -D warnings\n```\n\n## Dependencies\n- Depends on: bridle-dsh (Serialize derives)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:33:58.575275Z","updated_at":"2025-12-29T21:46:14.309477Z","closed_at":"2025-12-29T21:46:14.309477Z","close_reason":"Created output.rs with OutputFormat enum, ResolvedFormat, is_nushell detection, and output/output_list functions","dependencies":[{"issue_id":"bridle-3do","depends_on_id":"bridle-dsh","type":"blocks","created_at":"2025-12-28T22:36:03.298851Z","created_by":"daemon"}]}
{"id":"bridle-4gk","title":"Skills/Commands/Agents extraction uses harness system paths not profile paths","description":"In manager.rs, extract_profile_info() uses harness.skills(Scope::Global), harness.commands(Scope::Global), etc. which query the harness's system-level directories rather than the profile-specific directories.\n\n## Verification Steps\n\n1. Create directories in a test profile:\n   ```bash\n   mkdir -p ~/.config/bridle/profiles/opencode/test/agent\n   mkdir -p ~/.config/bridle/profiles/opencode/test/command\n   mkdir -p ~/.config/bridle/profiles/opencode/test/skill\n   echo '# Test Agent' \u003e ~/.config/bridle/profiles/opencode/test/agent/test-agent.md\n   echo '# Test Command' \u003e ~/.config/bridle/profiles/opencode/test/command/test-cmd.md\n   ```\n\n2. Run profile show:\n   ```bash\n   cargo run -- profile show opencode test\n   ```\n\n3. **Before fix**: Skills, Commands, Agents all show 'directory not found'\n\n4. **After fix**: Should show:\n   ```\n   Agents: 1 (test-agent)\n   Commands: 1 (test-cmd)\n   Skills: directory not found  # (if no skill dir, that's ok)\n   ```\n\n5. Verify it looks at profile path, not harness system path:\n   - Should read from: ~/.config/bridle/profiles/opencode/test/agent/\n   - NOT from: ~/.config/opencode/agent/\n\n## Affected Harnesses\n- OpenCode: agent/, command/, skill/ directories\n- Claude Code: commands/ directory\n- Goose: May have extensions but uses different structure","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-28T14:37:31.917866Z","updated_at":"2025-12-29T15:59:38.85042Z","closed_at":"2025-12-29T15:59:38.85042Z","close_reason":"Fixed: fallback to *.md pattern when harness.agents() returns empty results"}
{"id":"bridle-7qw","title":"Auto-save active profile before switching","description":"When switching profiles, bridle should save the current live config back to the active profile BEFORE copying the new profile over.\n\n**Current behavior:** switch_profile() only copies profile → live config, losing any edits made to the live config.\n\n**Expected behavior:** \n1. Check if there's an active profile for this harness\n2. If yes, copy live config → active profile (save changes)\n3. Then copy new profile → live config\n\n**Reproduction:**\n1. Switch to Profile A\n2. Edit the harness config externally (add MCP server, change setting)\n3. Switch to Profile B\n4. Switch back to Profile A\n5. Edits from step 2 are gone\n\n**Fix location:** ProfileManager::switch_profile() in src/config/manager.rs","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-28T11:45:16.241673Z","updated_at":"2025-12-28T11:47:43.102919Z","closed_at":"2025-12-28T11:47:43.102919Z","close_reason":"Fixed: switch_profile now auto-saves current live config back to active profile before switching, preventing edit loss."}
{"id":"bridle-94s","title":"AMP Code model field not parsed (flat key structure)","description":"## Problem\nAMP Code model shows '(not set)' even when configured.\n\n## Evidence\nConfig has `\"amp.model.default\": \"claude-sonnet-4-20250514\"` but parser shows not set.\n\n## Preliminary Analysis\n`extract_model_ampcode()` expects nested JSON `{\"amp\":{\"model\":...}}` but AMP uses FLAT keys like `\"amp.model.default\"`.\n\n## Research Required\n**Agent must verify**: Is this a bridle logic bug (wrong JSON structure assumption) or does `harness-locate` provide incorrect parsing guidance for AMP?\n\nCheck:\n1. Confirm AMP's official settings.json structure (flat vs nested)\n2. Does `harness-locate` provide model extraction for AMP?\n3. What's the correct JSON path to extract AMP's model?\n\n## Test Command\n```bash\ncargo run -- profile show amp-code full-test\n```","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T18:22:54.466809Z","updated_at":"2025-12-29T20:14:14.427222Z","closed_at":"2025-12-29T20:14:14.427222Z","close_reason":"Fixed AMP flat key parsing - model and theme now extracted correctly"}
{"id":"bridle-957","title":"OpenCode agents treated as directories instead of config","description":"## Problem\nParser shows 'Agents: (directory not found)' for OpenCode, but agents are configured IN the config file, not as directories.\n\n## Evidence\nConfig has `agent.general` and `agent.build` with model/temperature settings, but parser looks for directories.\n\n## Preliminary Analysis\n`extract_agents()` calls `harness.agents(\u0026Scope::Global)` expecting directory paths. For OpenCode, agents are defined inline in `opencode.jsonc`.\n\n## Research Required\n**Agent must verify**: Is this a bridle logic bug or does `harness-locate` incorrectly report OpenCode agents as directory-based?\n\nCheck:\n1. What does `harness.agents(\u0026Scope::Global)` return for OpenCode?\n2. Does `harness-locate` distinguish between config-based and directory-based agents?\n3. Should bridle have harness-specific agent parsing logic?\n\n## Test Command\n```bash\ncargo run -- profile show opencode full-test\n```","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-29T18:22:50.491775Z","updated_at":"2025-12-29T20:50:52.295944Z","closed_at":"2025-12-29T20:50:52.295944Z","close_reason":"Documented as harness-locate issue - agents() only returns directory path, not config-based agents. See harness-locate-bugs.md Issue 3"}
{"id":"bridle-979","title":"OpenCode MCP servers not parsed","description":"## Problem\nOpenCode MCP servers show '(none)' even when configured in `opencode.jsonc`.\n\n## Evidence\nConfig has 5 MCP servers under `mcp` key but parser shows none.\n\n## Preliminary Analysis\nBridle's `extract_mcp_servers()` looks for a SEPARATE MCP file via `harness.mcp_filename()`. OpenCode embeds MCP config directly in `opencode.jsonc` at the `mcp` key - there is no separate file.\n\n## Research Required\n**Agent must verify**: Is this a bridle logic bug or does `harness-locate` incorrectly report OpenCode's MCP location?\n\nCheck:\n1. What does `harness.mcp_filename()` return for OpenCode?\n2. What does `harness.mcp_config_path()` return?\n3. Does `harness-locate` provide a way to indicate embedded MCP configs?\n4. Should bridle handle embedded vs separate MCP configs differently?\n\n## Test Command\n```bash\ncargo run -- profile show opencode full-test\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T18:22:46.458489Z","updated_at":"2025-12-29T20:38:36.069852Z","closed_at":"2025-12-29T20:38:36.069852Z","close_reason":"Fixed OpenCode MCP parsing - tests passing"}
{"id":"bridle-98z","title":"Skills/Commands directories not found in profiles (all harnesses)","description":"## Problem\nParser shows '(directory not found)' or '(none)' for skills/commands even when directories exist in profile.\n\n## Evidence\n- Created directories at `~/.config/bridle/profiles/{harness}/full-test/skills/` and `.../commands/`\n- Files verified with `ls`\n- Parser still shows not found\n\n## Preliminary Analysis\n`init.rs` calls `create_from_current_if_missing` with `None` for `harness_for_resources`, so resource directories may not be copied. However `profile.rs` passes `Some(\u0026harness)`.\n\n## Research Required\n**Agent must verify**: Is this a bridle logic bug or does `harness-locate` return incorrect paths for skills/commands directories?\n\nCheck:\n1. What does `harness.skills(\u0026Scope::Global)` return for each harness?\n2. Is the directory name extraction logic correct?\n3. Does `create_from_current` properly copy these directories?\n\n## Affected\nAll 4 harnesses: Claude Code, OpenCode, Goose, AMP Code\n\n## Test Command\n```bash\ncargo run -- profile show claude-code full-test\n```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T18:22:38.454569Z","updated_at":"2025-12-29T20:48:04.082024Z","closed_at":"2025-12-29T20:48:04.082024Z","close_reason":"Documented as harness-locate design issue - inconsistent directory structures between skills (nested) and commands (flat) in OpenCode. See harness-locate-bugs.md"}
{"id":"bridle-apb","title":"Add JSON output to bridle status command","description":"## Parent Epic\nbridle-xgw: Nushell-friendly structured output for CLI display commands\n\n## Objective\nRefactor `bridle status` to support JSON output while preserving existing text output.\n\n## File to Modify: src/cli/status.rs\n\n### New Data Structure for Status Output\n\nCreate a serializable struct to represent status output:\n\n```rust\nuse serde::Serialize;\n\n#[derive(Debug, Serialize)]\npub struct StatusOutput {\n    pub harnesses: Vec\u003cHarnessStatus\u003e,\n    pub active_profiles: Vec\u003cActiveProfile\u003e,\n}\n\n#[derive(Debug, Serialize)]\npub struct HarnessStatus {\n    pub id: String,\n    pub name: String,\n    pub installed: bool,\n    pub config_path: Option\u003cString\u003e,\n}\n\n#[derive(Debug, Serialize)]\npub struct ActiveProfile {\n    pub harness: String,\n    pub profile: String,\n}\n```\n\n### Refactored display_status()\n\n```rust\nuse crate::cli::output::{ResolvedFormat, output};\n\npub fn display_status(format: ResolvedFormat) -\u003e Result\u003c()\u003e {\n    let config = BridleConfig::load()?;\n    \n    // Build status data\n    let harnesses: Vec\u003cHarnessStatus\u003e = HarnessKind::ALL\n        .iter()\n        .map(|kind| {\n            let adapter = HarnessAdapter::new(*kind);\n            HarnessStatus {\n                id: kind.id().to_string(),\n                name: kind.display_name().to_string(),\n                installed: adapter.config_path().exists(),\n                config_path: adapter.config_path()\n                    .exists()\n                    .then(|| adapter.config_path().display().to_string()),\n            }\n        })\n        .collect();\n\n    let active_profiles: Vec\u003cActiveProfile\u003e = config\n        .active_profiles\n        .iter()\n        .map(|(harness, profile)| ActiveProfile {\n            harness: harness.clone(),\n            profile: profile.clone(),\n        })\n        .collect();\n\n    let status = StatusOutput { harnesses, active_profiles };\n\n    // Output in requested format\n    output(\u0026status, format, |s| print_status_text(s));\n    \n    Ok(())\n}\n\nfn print_status_text(status: \u0026StatusOutput) {\n    // Existing println! logic moved here\n    println!(\"\\nHarness Status:\");\n    println!(\"{:-\u003c50}\", \"\");\n    for h in \u0026status.harnesses {\n        let status_icon = if h.installed { \"✓\" } else { \"✗\" };\n        println!(\"  {} {} - {}\", status_icon, h.name, \n            h.config_path.as_deref().unwrap_or(\"not installed\"));\n    }\n    // ... active profiles section\n}\n```\n\n### JSON Output Example\n\n```json\n{\n  \"harnesses\": [\n    {\n      \"id\": \"opencode\",\n      \"name\": \"OpenCode\", \n      \"installed\": true,\n      \"config_path\": \"/Users/d0/.config/opencode/opencode.jsonc\"\n    },\n    {\n      \"id\": \"claude\",\n      \"name\": \"Claude Code\",\n      \"installed\": true,\n      \"config_path\": \"/Users/d0/.claude/settings.json\"\n    }\n  ],\n  \"active_profiles\": [\n    {\"harness\": \"opencode\", \"profile\": \"test\"},\n    {\"harness\": \"claude\", \"profile\": \"default\"}\n  ]\n}\n```\n\n### Nushell Usage Examples\n\n```bash\n# List installed harnesses\nbridle status | from json | get harnesses | where installed == true\n\n# Get active profile for a harness\nbridle status | from json | get active_profiles | where harness == \"claude\"\n```\n\n## Verification\n```bash\ncargo run -- status                    # Text output (default)\ncargo run -- -o json status            # JSON output\ncargo run -- -o json status | jq .     # Validate JSON\nNU_VERSION=1 cargo run -- status       # Auto-detect JSON in Nushell\n```\n\n## Dependencies\n- Depends on: bridle-kv8 (global --output flag)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:34:42.856979Z","updated_at":"2025-12-29T21:59:48.287194Z","closed_at":"2025-12-29T21:59:48.287194Z","close_reason":"Added JSON output to status command with StatusOutput and HarnessStatus structs","dependencies":[{"issue_id":"bridle-apb","depends_on_id":"bridle-nfd","type":"blocks","created_at":"2025-12-28T22:36:03.456473Z","created_by":"daemon"}]}
{"id":"bridle-aq7","title":"TUI expandable profile detail view","description":"## Goal\nImplement inline expansion for selected profile in the TUI profile list, showing full details.\n\n## Dependencies\n- Depends on: bridle-jm3 (Wire up extraction)\n\n## Design\nExpandable detail view - selected profile expands inline:\n\n```\n┌──────────────┬──────────────────────────────────────────────┐\n│  Harnesses   │              Profiles                        │\n│    (25%)     │               (75%)                          │\n├──────────────┼──────────────────────────────────────────────┤\n│ ► Claude     │ ● my-profile ────────────────────────────    │\n│   OpenCode   │   │ Theme: catppuccin  Model: claude-sonnet  │\n│   Goose      │   │ MCP: ✓filesystem ✓github ✗postgres       │\n│              │   │ Skills: 5  Commands: 3  Plugins: 2       │\n│              │   │ Rules: AGENTS.md                         │\n│              │   │ ⚠ Error: Failed to parse config          │\n│              │   └──────────────────────────────────────    │\n│              │   work-profile (3 MCP)                       │\n│              │   minimal (1 MCP)                            │\n└──────────────┴──────────────────────────────────────────────┘\n```\n\n## Changes to src/tui/mod.rs\n\n### State Changes\n```rust\nstruct App {\n    // ... existing fields\n    expanded_profile: Option\u003cusize\u003e,  // Index of expanded profile, if any\n}\n```\n\n### New Rendering Functions\n```rust\n/// Render compact single-line profile view\nfn render_profile_compact(profile: \u0026ProfileInfo) -\u003e Line {\n    // Format: \"● name (N MCP)\" or \"  name (N MCP)\"\n}\n\n/// Render expanded multi-line profile view\nfn render_profile_expanded(profile: \u0026ProfileInfo) -\u003e Vec\u003cLine\u003e {\n    // Line 1: Name + active marker + separator line\n    // Line 2: Theme + Model (show \"(not supported)\" where applicable)\n    // Line 3: MCP servers with ✓/✗ indicators\n    // Line 4: Resource counts (Skills, Commands, Plugins, Agents)\n    // Line 5: Rules file if present\n    // Line 6+: Errors if any (in yellow/red)\n    // Final: closing separator line\n}\n```\n\n### Update render_profiles()\n- Check if profile index matches expanded_profile\n- Use render_profile_expanded() for expanded, render_profile_compact() for others\n- Handle variable height items in scroll calculations\n\n### Key Bindings\n- Space or Enter on profile: Toggle expansion\n- If already expanded, collapse; if collapsed, expand\n- Only one profile expanded at a time\n\n### Visual Styling\n- Use colors: Green for enabled MCP, Red for disabled\n- Yellow/Red for error messages\n- Box-drawing characters for expanded view borders\n- Active profile marker: ● (green if possible)\n\n## Acceptance Criteria\n- [ ] Selected profile expands to show full details inline\n- [ ] Unselected profiles show compact single-line view\n- [ ] Space/Enter toggles expansion\n- [ ] Only one profile expanded at a time\n- [ ] MCP servers show ✓/✗ with colors\n- [ ] \"(not supported)\" shown for harness-specific features\n- [ ] Errors displayed in expanded view\n- [ ] Scrolling works correctly with variable height items\n- [ ] cargo clippy passes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-28T12:00:37.48689Z","updated_at":"2025-12-28T13:50:47.441585Z","closed_at":"2025-12-28T13:50:47.441585Z","close_reason":"TUI expandable profile view complete","dependencies":[{"issue_id":"bridle-aq7","depends_on_id":"bridle-i0u","type":"blocks","created_at":"2025-12-28T12:00:47.31631Z","created_by":"daemon"}]}
{"id":"bridle-aq7.1","title":"Phase 1: Add expansion state to App struct","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T13:45:47.756296Z","updated_at":"2025-12-28T13:50:47.338429Z","closed_at":"2025-12-28T13:50:47.338429Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-aq7.1","depends_on_id":"bridle-aq7","type":"parent-child","created_at":"2025-12-28T13:45:47.759424Z","created_by":"daemon"}]}
{"id":"bridle-aq7.2","title":"Phase 2: Create render_profile_compact and render_profile_expanded functions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T13:45:48.761181Z","updated_at":"2025-12-28T13:50:47.353993Z","closed_at":"2025-12-28T13:50:47.353993Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-aq7.2","depends_on_id":"bridle-aq7","type":"parent-child","created_at":"2025-12-28T13:45:48.76293Z","created_by":"daemon"}]}
{"id":"bridle-aq7.3","title":"Phase 3: Update render_profile_pane to use new render functions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T13:45:49.407716Z","updated_at":"2025-12-28T13:50:47.355347Z","closed_at":"2025-12-28T13:50:47.355347Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-aq7.3","depends_on_id":"bridle-aq7","type":"parent-child","created_at":"2025-12-28T13:45:49.409667Z","created_by":"daemon"}]}
{"id":"bridle-aq7.4","title":"Phase 4: Implement Space/Enter key bindings for expansion toggle","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T13:45:50.530452Z","updated_at":"2025-12-28T13:50:47.359465Z","closed_at":"2025-12-28T13:50:47.359465Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-aq7.4","depends_on_id":"bridle-aq7","type":"parent-child","created_at":"2025-12-28T13:45:50.532021Z","created_by":"daemon"}]}
{"id":"bridle-b1h","title":"Profile creation skips resource directories (agent/, command/, skill/)","description":"## Problem\nWhen creating a profile with `--from-current`, only config FILES are copied to the profile storage. Resource directories (agent/, command/, skill/) are skipped because `copy_config_files` at line 257 only copies entries where `is_file()` is true.\n\n## Evidence\n- Live config at `~/.config/opencode/` HAS `agent/` and `command/` directories\n- Profile storage at `~/.config/bridle/profiles/opencode/maestro/` has NO directories, only files\n- TUI shows '(directory not found)' for Agents, Skills, Commands\n\n## Root Cause\n`src/config/manager.rs` line 257:\n```rust\nif entry.file_type()?.is_file() {  // \u003c-- ONLY FILES\n    let dest = profile_path.join(entry.file_name());\n    std::fs::copy(entry.path(), \u0026dest)?;\n}\n```\n\n## Fix\nModify `copy_config_files` to also recursively copy resource directories when `source_is_live=true`. The harness provides directory names via `harness.agents()`, `harness.commands()`, `harness.skills()` - use these to identify which directories to copy.\n\n## Acceptance Criteria\n- `profile create \u003charness\u003e \u003cname\u003e --from-current` copies agent/, command/, skill/ directories\n- `profile show` displays resources correctly for both CLI and TUI\n- Existing profiles may need migration or re-creation","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-29T14:14:02.142201Z","updated_at":"2025-12-29T14:26:01.367097Z","closed_at":"2025-12-29T14:26:01.367097Z","close_reason":"Root cause documented - copy_config_files only copies files, not directories"}
{"id":"bridle-b9m","title":"Add tree layout with item breakdown to TUI profile display","description":"Improve TUI expanded profile view: (1) fix spacing bug between ✓/✗ and MCP name, (2) show plugin/skill names instead of just counts for OpenCode, (3) use tree structure layout for all harnesses. Data already available in ProfileInfo.items - purely rendering change.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-28T15:42:40.142832Z","updated_at":"2025-12-28T15:58:50.38446Z","closed_at":"2025-12-28T15:58:50.38446Z","close_reason":"Tree layout implemented: Theme/Model/MCP/Resources/Rules with proper branch markers, individual item listings, and ✓/✗ status for MCP servers. All quality gates pass (fmt, clippy, 16 tests)."}
{"id":"bridle-ded","title":"Config extractors for theme, model, and MCP status","description":"## Goal\nParse harness-specific config files to extract theme, model, and MCP server details with enabled status.\n\n## Dependencies\n- Depends on: bridle-jm0 (Enhanced ProfileInfo data structures)\n\n## Changes\n\nAdd config extraction methods:\n\n```rust\nimpl ProfileManager {\n    /// Extract MCP servers with name and enabled status\n    pub fn extract_mcp_servers(\u0026self, harness: \u0026Harness, scope: Scope) -\u003e Result\u003cVec\u003cMcpServerInfo\u003e, String\u003e {\n        let servers = harness.parse_mcp_config(scope)?;\n        Ok(servers.into_iter().map(|(name, server)| {\n            McpServerInfo {\n                name,\n                enabled: match server {\n                    McpServer::Stdio(s) =\u003e s.enabled.unwrap_or(true),\n                    McpServer::Sse(s) =\u003e s.enabled.unwrap_or(true),\n                    McpServer::Http(s) =\u003e s.enabled.unwrap_or(true),\n                },\n            }\n        }).collect())\n    }\n    \n    /// Extract theme (OpenCode only, returns None for others)\n    pub fn extract_theme(\u0026self, harness: \u0026Harness, profile_path: \u0026Path) -\u003e Option\u003cString\u003e {\n        match harness.kind() {\n            HarnessKind::OpenCode =\u003e {\n                // Parse opencode.jsonc for \"theme\" field\n                let config_path = profile_path.join(\"opencode.jsonc\");\n                // ... parse and extract\n            }\n            _ =\u003e None,  // Not supported for Claude Code or Goose\n        }\n    }\n    \n    /// Extract model from config\n    pub fn extract_model(\u0026self, harness: \u0026Harness, profile_path: \u0026Path) -\u003e Option\u003cString\u003e {\n        match harness.kind() {\n            HarnessKind::ClaudeCode =\u003e {\n                // Parse settings.json for \"model\" field\n            }\n            HarnessKind::OpenCode =\u003e {\n                // Parse opencode.jsonc for \"model\" field\n            }\n            HarnessKind::Goose =\u003e {\n                // Parse config.yaml for \"GOOSE_MODEL\" or \"default_model\"\n            }\n        }\n    }\n}\n```\n\n## Config File Locations\n- Claude Code: settings.json (JSON)\n- OpenCode: opencode.jsonc (JSONC - need to handle comments)\n- Goose: config.yaml (YAML)\n\n## Error Handling\n- Capture parsing errors in extraction_errors field\n- Don't fail entire extraction if one field fails\n- Return descriptive error messages for display\n\n## Acceptance Criteria\n- [ ] extract_mcp_servers() returns Vec\u003cMcpServerInfo\u003e with enabled status\n- [ ] extract_theme() returns theme for OpenCode, None for others\n- [ ] extract_model() works for all three harnesses\n- [ ] JSONC parsing handles comments correctly\n- [ ] YAML parsing works for Goose config\n- [ ] Parsing errors captured, not thrown\n- [ ] cargo test passes\n- [ ] cargo clippy passes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T12:00:04.831026Z","updated_at":"2025-12-28T12:53:46.184769Z","closed_at":"2025-12-28T12:53:46.184769Z","close_reason":"Implemented config extractors for theme, model, and MCP enabled status","dependencies":[{"issue_id":"bridle-ded","depends_on_id":"bridle-jm0","type":"blocks","created_at":"2025-12-28T12:00:46.861781Z","created_by":"daemon"}]}
{"id":"bridle-dsh","title":"Add Serialize derives to data structures","description":"## Parent Epic\nbridle-xgw: Nushell-friendly structured output for CLI display commands\n\n## Objective\nAdd `#[derive(Serialize)]` to all data structures that will be output as JSON.\n\n## Files to Modify\n\n### src/config/manager.rs\nAdd Serialize derive to:\n- `McpServerInfo` - MCP server name and enabled status\n- `ResourceSummary` - items list and directory_exists flag  \n- `ProfileInfo` - full profile information\n\n### Current State\n```rust\n#[derive(Debug, Clone)]\npub struct McpServerInfo {\n    pub name: String,\n    pub enabled: bool,\n}\n\n#[derive(Debug, Clone)]\npub struct ResourceSummary {\n    pub items: Vec\u003cString\u003e,\n    pub directory_exists: bool,\n}\n\n#[derive(Debug, Clone)]\npub struct ProfileInfo {\n    pub name: String,\n    pub harness_id: String,\n    pub is_active: bool,\n    pub path: PathBuf,\n    pub mcp_servers: Vec\u003cMcpServerInfo\u003e,\n    pub skills: ResourceSummary,\n    pub commands: ResourceSummary,\n    pub plugins: ResourceSummary,\n    pub agents: ResourceSummary,\n    pub rules_file: Option\u003cString\u003e,\n    pub theme: Option\u003cString\u003e,\n    pub model: Option\u003cString\u003e,\n    pub extraction_errors: Vec\u003cString\u003e,\n}\n```\n\n### Target State\n```rust\nuse serde::Serialize;\n\n#[derive(Debug, Clone, Serialize)]\npub struct McpServerInfo { ... }\n\n#[derive(Debug, Clone, Serialize)]\npub struct ResourceSummary { ... }\n\n#[derive(Debug, Clone, Serialize)]\npub struct ProfileInfo { ... }\n```\n\n## JSON Output Examples\n\n### ProfileInfo\n```json\n{\n  \"name\": \"test\",\n  \"harness_id\": \"opencode\",\n  \"is_active\": true,\n  \"path\": \"/Users/d0/.config/bridle/profiles/opencode/test\",\n  \"mcp_servers\": [\n    {\"name\": \"filesystem\", \"enabled\": true},\n    {\"name\": \"github\", \"enabled\": true}\n  ],\n  \"skills\": {\"items\": [\"rust\", \"python\"], \"directory_exists\": true},\n  \"commands\": {\"items\": [], \"directory_exists\": false},\n  \"plugins\": {\"items\": [\"plugin1\"], \"directory_exists\": true},\n  \"agents\": {\"items\": [], \"directory_exists\": false},\n  \"rules_file\": \"RULES.md\",\n  \"theme\": \"dark\",\n  \"model\": \"claude-sonnet-4-20250514\",\n  \"extraction_errors\": []\n}\n```\n\n## Verification\n```bash\ncargo check  # Ensure Serialize derives compile\ncargo clippy -- -D warnings  # No new warnings\n```\n\n## Notes\n- serde is already in Cargo.toml with derive feature\n- PathBuf serializes as string automatically\n- Option\u003cT\u003e serializes as null or value\n- Vec\u003cT\u003e serializes as JSON array","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:33:32.857308Z","updated_at":"2025-12-29T20:49:24.858846Z","closed_at":"2025-12-29T20:49:24.858846Z","close_reason":"Added Serialize derives to McpServerInfo, ResourceSummary, and ProfileInfo in manager.rs"}
{"id":"bridle-fk7","title":"AMP Code MCP servers parsing error","description":"## Problem\nAMP Code MCP parsing throws error: 'Stdio server missing command field'.\n\n## Evidence\nConfig has valid `amp.mcpServers` with `{command: \"npx\", args: [...]}` structure but parsing fails.\n\n## Preliminary Analysis\nAMP uses format `{command: \"npx\", args: [...]}` but `harness-locate` may expect `{command: [\"npx\", ...]}` array format. Error suggests the library can't find the command field.\n\n## Research Required\n**Agent must verify**: Is this a bridle bug, a harness-locate bug, or a format mismatch?\n\nCheck:\n1. What MCP format does AMP Code officially use?\n2. What format does `harness-locate::parse_mcp_servers()` expect?\n3. Does bridle pre-process the config before passing to library?\n4. Is the error from bridle or from harness-locate?\n\n## Test Command\n```bash\ncargo run -- profile show amp-code full-test\n```","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-29T18:23:01.153308Z","updated_at":"2025-12-29T19:43:42.644279Z","closed_at":"2025-12-29T19:43:42.644279Z","close_reason":"Fixed in harness-locate - type inference now works for AMP Code MCP servers"}
{"id":"bridle-g7a","title":"TUI Polish: Help Modal, Empty States, Edge Cases","description":"# TUI Polish \u0026 Edge Cases\n\n**Epic**: bridle-pm8 (TUI Redesign)\n**Phase**: 5 of 5\n**Depends on**: bridle-z15 (Dashboard), bridle-s70 (Card View)\n\n## Objective\nFinal polish pass for both TUI views: adaptive help modal, empty states, and edge case handling.\n\n## 1. Adaptive Help Modal\n\nHelp modal content adapts based on current view mode.\n\n### Implementation\n\n**File**: `src/tui/mod.rs` (update existing `render_help_modal`)\n\n```rust\nfn render_help_modal(frame: \u0026mut Frame, area: Rect, view_mode: ViewMode) {\n    let mut help_text = vec![\n        Line::from(Span::styled(\"Navigation\", Style::default().add_modifier(Modifier::BOLD))),\n        Line::from(\"  ← / h     Previous harness\"),\n        Line::from(\"  → / l     Next harness\"),\n    ];\n    \n    // View-specific navigation\n    match view_mode {\n        ViewMode::Dashboard =\u003e {\n            help_text.extend([\n                Line::from(\"  j / ↓     Next profile\"),\n                Line::from(\"  k / ↑     Previous profile\"),\n            ]);\n        }\n        #[cfg(feature = \"tui-cards\")]\n        ViewMode::Cards =\u003e {\n            help_text.extend([\n                Line::from(\"  j / ↓     Next row of cards\"),\n                Line::from(\"  k / ↑     Previous row of cards\"),\n            ]);\n        }\n    }\n    \n    help_text.extend([\n        Line::from(\"\"),\n        Line::from(Span::styled(\"Actions\", Style::default().add_modifier(Modifier::BOLD))),\n        Line::from(\"  Enter     Switch to profile\"),\n        Line::from(\"  Space     Show details\"),\n        Line::from(\"  n         New profile\"),\n        Line::from(\"  d         Delete profile\"),\n        Line::from(\"  e         Edit profile\"),\n        Line::from(\"  r         Refresh\"),\n        Line::from(\"\"),\n        Line::from(Span::styled(\"Harness Status\", Style::default().add_modifier(Modifier::BOLD))),\n        Line::from(\"  ●         Managed (has active profile)\"),\n        Line::from(\"  +         Installed with config\"),\n        Line::from(\"  -         Binary only (no config)\"),\n        Line::from(\"            Not installed (grayed)\"),\n        Line::from(\"\"),\n        Line::from(Span::styled(\"General\", Style::default().add_modifier(Modifier::BOLD))),\n        Line::from(\"  ?         Toggle help\"),\n        Line::from(\"  q / Esc   Quit\"),\n    ]);\n    \n    // Add view indicator\n    help_text.push(Line::from(\"\"));\n    let view_name = match view_mode {\n        ViewMode::Dashboard =\u003e \"Dashboard\",\n        #[cfg(feature = \"tui-cards\")]\n        ViewMode::Cards =\u003e \"Cards\",\n    };\n    help_text.push(Line::styled(\n        format!(\"Current view: {}\", view_name),\n        Style::default().fg(Color::DarkGray)\n    ));\n    \n    // Render modal (same positioning logic as before)\n    let width = 45;\n    let height = help_text.len() as u16 + 4;\n    let x = area.width.saturating_sub(width) / 2;\n    let y = area.height.saturating_sub(height) / 2;\n    let modal_area = Rect::new(x, y, width.min(area.width), height.min(area.height));\n    \n    frame.render_widget(Clear, modal_area);\n    \n    let block = Block::default()\n        .title(\" Help \")\n        .title_alignment(Alignment::Center)\n        .borders(Borders::ALL)\n        .border_style(Style::default().fg(Color::Cyan))\n        .style(Style::default().bg(Color::Black));\n    \n    Paragraph::new(help_text).block(block).render(modal_area, buf);\n}\n```\n\n## 2. Empty States\n\n### Dashboard: No Profiles\n```\n┌─ Profiles ───────────────────┬─ Details ────────────────────┐\n│                              │                              │\n│                              │                              │\n│     No profiles yet          │   Select a profile to view   │\n│                              │   details                    │\n│     Press 'n' to create      │                              │\n│                              │                              │\n└──────────────────────────────┴──────────────────────────────┘\n```\n\n### Dashboard: Harness Not Installed\n```\n┌─ Profiles ───────────────────┬─ Details ────────────────────┐\n│                              │                              │\n│                              │                              │\n│  Goose is not installed      │                              │\n│                              │                              │\n│  Install it to manage        │                              │\n│  profiles                    │                              │\n└──────────────────────────────┴──────────────────────────────┘\n```\n\n### Card View: No Profiles\nOnly the \"+ New Profile\" card shows.\n\n### Implementation\n\n```rust\n// In ProfileTable widget\nfn render_empty_state(area: Rect, buf: \u0026mut Buffer, message: \u0026str, hint: \u0026str) {\n    let block = Block::default()\n        .title(\" Profiles \")\n        .borders(Borders::ALL)\n        .border_style(Theme::BORDER_INACTIVE);\n    \n    let inner = block.inner(area);\n    block.render(area, buf);\n    \n    let text = vec![\n        Line::raw(\"\"),\n        Line::styled(message, Style::default().fg(Color::DarkGray)),\n        Line::raw(\"\"),\n        Line::styled(hint, Style::default().fg(Color::DarkGray).add_modifier(Modifier::ITALIC)),\n    ];\n    \n    Paragraph::new(text)\n        .alignment(Alignment::Center)\n        .render(inner, buf);\n}\n```\n\n## 3. Edge Cases\n\n### Long Profile Names\n- Truncate with ellipsis in table/card title\n- Full name shown in detail pane\n\n```rust\nfn truncate_name(name: \u0026str, max_len: usize) -\u003e String {\n    if name.len() \u003c= max_len {\n        name.to_string()\n    } else {\n        format!(\"{}…\", \u0026name[..max_len-1])\n    }\n}\n```\n\n### Long Model Names  \n- Already handled: split on '/' and take last segment\n- Further truncate to 18 chars in table\n\n### Many MCP Servers\n- Dashboard detail pane: Show all (scrollable if needed)\n- Card view: Truncate with \"+N more\"\n\n### Very Long MCP Server Names\n```rust\nfn truncate_server_name(name: \u0026str) -\u003e \u0026str {\n    if name.len() \u003e 20 {\n        \u0026name[..17].trim_end()  // Leave room for \"...\"\n    } else {\n        name\n    }\n}\n```\n\n### Unicode in Names\n- Ensure proper width calculation using `unicode-width` crate (optional)\n- Or just treat all chars as width 1 (simpler, may misalign CJK)\n\n### Terminal Resize\n- Layout recalculates on each frame (already handled by ratatui)\n- Card view columns adjust automatically\n\n### No Harness Selected (edge case)\n- Should never happen (always select first harness on init)\n- Defensive: show \"Select a harness\" message\n\n## 4. Detail Modal for Card View\n\nWhen user presses Space in card view, show a modal with full details.\n\n```rust\n#[cfg(feature = \"tui-cards\")]\nfn render_detail_modal(frame: \u0026mut Frame, profile: \u0026ProfileInfo) {\n    let area = frame.area();\n    \n    // 80% width, 80% height, centered\n    let width = (area.width * 80 / 100).min(60);\n    let height = (area.height * 80 / 100).min(25);\n    let x = (area.width - width) / 2;\n    let y = (area.height - height) / 2;\n    let modal_area = Rect::new(x, y, width, height);\n    \n    frame.render_widget(Clear, modal_area);\n    \n    // Reuse DetailPane content rendering\n    let content = DetailPane::render_content(profile);\n    \n    let block = Block::default()\n        .title(format!(\" {} \", profile.name))\n        .title_alignment(Alignment::Center)\n        .borders(Borders::ALL)\n        .border_style(Style::default().fg(Color::Cyan))\n        .style(Style::default().bg(Color::Black));\n    \n    Paragraph::new(content).block(block).render(modal_area, frame.buffer_mut());\n}\n```\n\n## 5. Keyboard Handling Updates\n\n```rust\n// Space key behavior\nKeyCode::Char(' ') =\u003e {\n    match app.view_mode {\n        ViewMode::Dashboard =\u003e {\n            // Could toggle focus to detail pane for scrolling\n            // Or just ignore (details always visible)\n            app.status_message = Some(\"Details shown on right\".to_string());\n        }\n        #[cfg(feature = \"tui-cards\")]\n        ViewMode::Cards =\u003e {\n            app.show_detail_modal = true;\n        }\n    }\n}\n```\n\n## Acceptance Criteria\n\n- [ ] Help modal shows correct keybinds for current view\n- [ ] Help modal shows current view name at bottom\n- [ ] Empty state renders correctly (no profiles)\n- [ ] Empty state for uninstalled harness\n- [ ] Long names truncate with ellipsis\n- [ ] Many MCP servers handled gracefully\n- [ ] Card view detail modal works (Space key)\n- [ ] Terminal resize doesn't break layout\n\n## Testing\n\n```bash\n# Test empty states\ncargo run -- profile delete claude-code default\ncargo run -- tui\n\n# Test with many MCPs (edit config manually)\n# Test terminal resize (drag window while TUI running)\n# Test help modal (press ?)\n\n# Card view tests (if feature enabled)\ncargo run --features tui-cards -- tui\n# Press Space on a card to see detail modal\n```\n","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-28T17:10:49.630819Z","updated_at":"2025-12-28T19:25:44.256268Z","closed_at":"2025-12-28T19:25:44.256268Z","close_reason":"Added view-mode-aware help modal, empty state rendering for ProfileTable, truncation already existed. All Polish phase tasks complete.","dependencies":[{"issue_id":"bridle-g7a","depends_on_id":"bridle-z15","type":"blocks","created_at":"2025-12-28T17:10:58.81144Z","created_by":"daemon"},{"issue_id":"bridle-g7a","depends_on_id":"bridle-s70","type":"blocks","created_at":"2025-12-28T17:10:58.885729Z","created_by":"daemon"}]}
{"id":"bridle-gz6","title":"TUI Improvement Plan - First-run UX fixes","description":"Fix first-run TUI experience: empty profile lists, broken help, CLI-only profile creation, missing guidance. 5 beads covering auto-bootstrap, help modal, inline creation, empty states, and status indicators.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-28T10:15:54.931178Z","updated_at":"2025-12-28T10:51:48.624329Z","closed_at":"2025-12-28T10:51:48.624329Z","close_reason":"All child beads complete: auto-bootstrap (gz6.1), help modal (gz6.2), inline profile creation (gz6.3), empty state UX (gz6.6), status indicators (gz6.7). First-run TUI experience significantly improved."}
{"id":"bridle-gz6.1","title":"Auto-bootstrap profiles from current harness config","description":"On TUI launch or bridle init, detect installed harnesses with existing configs and auto-create a 'default' profile from their current configuration. Add ProfileManager::create_from_current_if_missing(). Idempotent - running twice doesn't duplicate. Skips BinaryOnly/ConfigOnly/NotInstalled harnesses.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-28T10:16:03.76339Z","updated_at":"2025-12-28T10:37:47.436226Z","closed_at":"2025-12-28T10:37:47.436226Z","close_reason":"Implemented auto-bootstrap profiles: added ProfileManager::create_from_current_if_missing(), hooked into TUI App::new() and bridle init. Only bootstraps FullyInstalled harnesses, idempotent.","dependencies":[{"issue_id":"bridle-gz6.1","depends_on_id":"bridle-gz6","type":"parent-child","created_at":"2025-12-28T10:16:03.765172Z","created_by":"daemon"}]}
{"id":"bridle-gz6.2","title":"Implement help modal (? key)","description":"Status bar shows 'Press ? for help' but pressing ? does nothing. Implement help popup/modal showing all keybindings. Add KeyCode::Char('?') handler, show_help state, render_help_modal(). Dismiss with ?, Esc, or q.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-28T10:16:07.034581Z","updated_at":"2025-12-28T10:41:17.704415Z","closed_at":"2025-12-28T10:41:17.704415Z","close_reason":"Implemented help modal: ? key toggles modal overlay with categorized keybindings. Dismiss with ?, Esc, or q. Visually distinct with cyan border.","dependencies":[{"issue_id":"bridle-gz6.2","depends_on_id":"bridle-gz6","type":"parent-child","created_at":"2025-12-28T10:16:07.03625Z","created_by":"daemon"}]}
{"id":"bridle-gz6.3","title":"Inline profile creation in TUI","description":"Pressing 'n' just shows 'Use CLI: bridle profile create'. Implement inline creation: n -\u003e creates profile from current harness config with name prompt. Add InputMode enum (Normal/CreatingProfile), input state, text input handling. Render input field at bottom of profile pane. Show error in status bar if name invalid/exists.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-28T10:16:11.321578Z","updated_at":"2025-12-28T10:44:38.068028Z","closed_at":"2025-12-28T10:44:38.068028Z","close_reason":"Implemented inline profile creation: n key opens input mode, type name + Enter creates profile from current config. Backspace for editing, Esc to cancel. Errors shown in status bar.","dependencies":[{"issue_id":"bridle-gz6.3","depends_on_id":"bridle-gz6","type":"parent-child","created_at":"2025-12-28T10:16:11.323372Z","created_by":"daemon"}]}
{"id":"bridle-gz6.6","title":"Empty state UX for profile pane","description":"After auto-bootstrap, empty profiles only happen in edge cases. Show contextual placeholder text based on harness state: NotInstalled -\u003e 'Not installed', BinaryOnly -\u003e 'Run harness once to generate config', ConfigOnly/empty -\u003e 'No config found'. Modify render_profile_pane() to detect empty list and check installation_status().","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-28T10:16:29.702839Z","updated_at":"2025-12-28T10:47:15.47193Z","closed_at":"2025-12-28T10:47:15.47193Z","close_reason":"Implemented empty state UX: contextual messages based on installation status (NotInstalled, BinaryOnly, ConfigOnly, FullyInstalled). Centered in profile pane with actionable guidance.","dependencies":[{"issue_id":"bridle-gz6.6","depends_on_id":"bridle-gz6","type":"parent-child","created_at":"2025-12-28T10:16:29.704691Z","created_by":"daemon"},{"issue_id":"bridle-gz6.6","depends_on_id":"bridle-gz6.1","type":"blocks","created_at":"2025-12-28T10:16:38.489985Z","created_by":"daemon"}]}
{"id":"bridle-gz6.7","title":"Show harness tracking status indicators","description":"User can't tell which harnesses Bridle is managing vs uncaptured. Show visual indicators in harness pane: * = has active Bridle profile, + = has config but no profile yet, - = binary only (no config), (space) = not installed. Modify render_harness_pane(), check installation_status() and mcp().exists(), cross-reference with active_profile_for(). Update help modal legend.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-28T10:16:31.810904Z","updated_at":"2025-12-28T10:51:16.968935Z","closed_at":"2025-12-28T10:51:16.968935Z","close_reason":"Implemented harness status indicators: * (tracked), + (has config), - (binary only), space (not installed). Indicators shown before harness names with legend in help modal.","dependencies":[{"issue_id":"bridle-gz6.7","depends_on_id":"bridle-gz6","type":"parent-child","created_at":"2025-12-28T10:16:31.813061Z","created_by":"daemon"}]}
{"id":"bridle-hue","title":"TUI Foundation: Config, Theme, Module Structure","description":"# TUI Foundation Setup\n\n**Epic**: bridle-pm8 (TUI Redesign)\n**Phase**: 1 of 5\n\n## Objective\nSet up the foundational structure for the TUI redesign including config support, theme constants, and module organization.\n\n## Tasks\n\n### 1. Add TUI Config to BridleConfig\n\n**File**: `src/config/bridle.rs`\n\nAdd view preference to config:\n\n```rust\n#[derive(Debug, Clone, Default, Serialize, Deserialize)]\npub struct TuiConfig {\n    #[serde(default)]\n    pub view: ViewPreference,\n}\n\n#[derive(Debug, Clone, Default, Serialize, Deserialize, PartialEq, Eq)]\n#[serde(rename_all = \"lowercase\")]\npub enum ViewPreference {\n    #[default]\n    Dashboard,\n    #[cfg(feature = \"tui-cards\")]\n    Cards,\n}\n\n// Update BridleConfig struct\n#[derive(Debug, Clone, Default, Serialize, Deserialize)]\npub struct BridleConfig {\n    #[serde(default)]\n    pub tui: TuiConfig,\n    \n    #[serde(default)]\n    pub active_profiles: HashMap\u003cString, String\u003e,\n}\n```\n\nConfig file format (`~/.config/bridle/config.toml`):\n```toml\n[tui]\nview = \"dashboard\"  # or \"cards\" when feature enabled\n\n[active_profiles]\nclaude-code = \"default\"\n```\n\n### 2. Add Feature Flag to Cargo.toml\n\n```toml\n[features]\ndefault = []\ntui-cards = []  # Enable card view\n```\n\n### 3. Create Theme Module\n\n**File**: `src/tui/theme.rs`\n\n```rust\nuse ratatui::style::{Color, Modifier, Style};\n\npub struct Theme;\n\nimpl Theme {\n    // Pane borders\n    pub const BORDER_ACTIVE: Style = Style::new().fg(Color::Cyan);\n    pub const BORDER_INACTIVE: Style = Style::new().fg(Color::DarkGray);\n    \n    // Harness tab indicators\n    pub const HARNESS_ACTIVE: Style = Style::new().fg(Color::Green).add_modifier(Modifier::BOLD);\n    pub const HARNESS_INSTALLED: Style = Style::new().fg(Color::White);\n    pub const HARNESS_NOT_INSTALLED: Style = Style::new().fg(Color::DarkGray);\n    \n    // Profile states\n    pub const PROFILE_ACTIVE: Style = Style::new().fg(Color::Green).add_modifier(Modifier::BOLD);\n    pub const PROFILE_SELECTED: Style = Style::new().bg(Color::DarkGray).add_modifier(Modifier::BOLD);\n    pub const PROFILE_NORMAL: Style = Style::new();\n    \n    // MCP server status\n    pub const MCP_ENABLED: Style = Style::new().fg(Color::Green);\n    pub const MCP_DISABLED: Style = Style::new().fg(Color::Red);\n    \n    // Status bar\n    pub const STATUS_KEYBIND: Style = Style::new().fg(Color::DarkGray);\n    pub const STATUS_MESSAGE: Style = Style::new().fg(Color::Yellow);\n    \n    // Detail pane sections\n    pub const SECTION_HEADER: Style = Style::new().add_modifier(Modifier::BOLD);\n    pub const SECTION_CONTENT: Style = Style::new().fg(Color::Gray);\n    pub const TREE_BRANCH: Style = Style::new().fg(Color::DarkGray);\n}\n```\n\n### 4. Create Module Structure\n\nCreate these files/directories:\n\n```\nsrc/tui/\n├── mod.rs              # Update to use new modules\n├── theme.rs            # NEW: Color/style constants\n├── views/\n│   ├── mod.rs          # NEW: ViewMode enum, View trait\n│   ├── dashboard.rs    # NEW: (placeholder for Phase 3)\n│   └── cards.rs        # NEW: (placeholder for Phase 4, feature-gated)\n└── widgets/\n    ├── mod.rs          # NEW: Re-exports\n    ├── harness_tabs.rs # NEW: (placeholder for Phase 2)\n    ├── profile_table.rs # NEW: (placeholder for Phase 3)\n    ├── detail_pane.rs  # NEW: (placeholder for Phase 3)\n    ├── profile_card.rs # NEW: (placeholder for Phase 4, feature-gated)\n    └── status_bar.rs   # NEW: (placeholder for Phase 2)\n```\n\n### 5. Create Views Module Base\n\n**File**: `src/tui/views/mod.rs`\n\n```rust\npub mod dashboard;\n\n#[cfg(feature = \"tui-cards\")]\npub mod cards;\n\nuse ratatui::Frame;\nuse crate::tui::App;\n\n#[derive(Debug, Clone, Copy, PartialEq, Eq, Default)]\npub enum ViewMode {\n    #[default]\n    Dashboard,\n    #[cfg(feature = \"tui-cards\")]\n    Cards,\n}\n\nimpl ViewMode {\n    pub fn from_config(preference: \u0026crate::config::ViewPreference) -\u003e Self {\n        match preference {\n            crate::config::ViewPreference::Dashboard =\u003e ViewMode::Dashboard,\n            #[cfg(feature = \"tui-cards\")]\n            crate::config::ViewPreference::Cards =\u003e ViewMode::Cards,\n        }\n    }\n}\n\npub trait View {\n    fn render(\u0026self, frame: \u0026mut Frame, app: \u0026mut App);\n    fn handle_key(\u0026self, app: \u0026mut App, key: crossterm::event::KeyCode);\n}\n```\n\n## Acceptance Criteria\n\n- [ ] `BridleConfig` loads and saves `tui.view` preference\n- [ ] Feature flag `tui-cards` compiles correctly when enabled/disabled\n- [ ] Theme module provides all color constants\n- [ ] Directory structure created with placeholder files\n- [ ] Existing TUI still works (no regressions)\n\n## Testing\n\n```bash\n# Verify feature flag works\ncargo check\ncargo check --features tui-cards\n\n# Verify config loads\ncargo test config\n\n# Verify TUI still runs\ncargo run -- tui\n```\n","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T17:07:42.711002Z","updated_at":"2025-12-28T19:15:55.743273Z","closed_at":"2025-12-28T19:15:55.743273Z","close_reason":"Implemented TUI foundation: TuiConfig/ViewPreference in BridleConfig, tui-cards feature flag, ViewMode::Cards variant (feature-gated), from_config method"}
{"id":"bridle-i0u","title":"Wire up extraction in show_profile()","description":"## Goal\nIntegrate all extraction methods to populate the enhanced ProfileInfo struct.\n\n## Dependencies\n- Depends on: bridle-jm0 (Enhanced ProfileInfo data structures)\n- Depends on: bridle-jm1 (Directory resource extractors)\n- Depends on: bridle-jm2 (Config extractors)\n\n## Changes\n\nUpdate ProfileManager::show_profile() in src/config/manager.rs:\n\n```rust\npub fn show_profile(\u0026self, harness: \u0026Harness, profile_name: \u0026str) -\u003e Result\u003cProfileInfo\u003e {\n    let profile_path = self.get_profile_path(harness, profile_name)?;\n    let mut extraction_errors = Vec::new();\n    \n    // Extract MCP servers with error capture\n    let mcp_servers = match self.extract_mcp_servers(harness, Scope::Project) {\n        Ok(servers) =\u003e servers,\n        Err(e) =\u003e {\n            extraction_errors.push(format!(\"MCP: {}\", e));\n            Vec::new()\n        }\n    };\n    \n    // Extract directory resources\n    let skills = self.extract_skills(harness, Scope::Project);\n    let commands = self.extract_commands(harness, Scope::Project);\n    let plugins = self.extract_plugins(harness, Scope::Project);\n    let agents = self.extract_agents(harness, Scope::Project);\n    let rules_file = self.extract_rules_file(harness, Scope::Project);\n    \n    // Extract config values with error capture\n    let theme = match self.extract_theme(harness, \u0026profile_path) {\n        Ok(t) =\u003e t,\n        Err(e) =\u003e {\n            extraction_errors.push(format!(\"Theme: {}\", e));\n            None\n        }\n    };\n    \n    let model = match self.extract_model(harness, \u0026profile_path) {\n        Ok(m) =\u003e m,\n        Err(e) =\u003e {\n            extraction_errors.push(format!(\"Model: {}\", e));\n            None\n        }\n    };\n    \n    Ok(ProfileInfo {\n        name: profile_name.to_string(),\n        harness_id: harness.kind().to_string(),\n        is_active: self.is_active_profile(harness, profile_name)?,\n        path: profile_path,\n        mcp_servers,\n        skills,\n        commands,\n        plugins,\n        agents,\n        rules_file,\n        theme,\n        model,\n        extraction_errors,\n    })\n}\n```\n\n## Acceptance Criteria\n- [ ] show_profile() populates all new ProfileInfo fields\n- [ ] Extraction errors captured in extraction_errors vec\n- [ ] Partial failures don't prevent returning ProfileInfo\n- [ ] Works correctly for all three harnesses\n- [ ] OpenCode-specific fields (plugins, agents, theme) populated\n- [ ] Claude/Goose show None for unsupported fields\n- [ ] cargo test passes\n- [ ] cargo clippy passes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T12:00:12.947828Z","updated_at":"2025-12-28T13:37:33.966021Z","closed_at":"2025-12-28T13:37:33.966021Z","close_reason":"Merged show_profile_full() into show_profile(\u0026Harness) - now extracts all fields (skills, commands, plugins, agents, rules_file) with error collection","dependencies":[{"issue_id":"bridle-i0u","depends_on_id":"bridle-jm0","type":"blocks","created_at":"2025-12-28T12:00:46.946586Z","created_by":"daemon"},{"issue_id":"bridle-i0u","depends_on_id":"bridle-pkd","type":"blocks","created_at":"2025-12-28T12:00:47.042481Z","created_by":"daemon"},{"issue_id":"bridle-i0u","depends_on_id":"bridle-ded","type":"blocks","created_at":"2025-12-28T12:00:47.131804Z","created_by":"daemon"}]}
{"id":"bridle-iia","title":"Claude Code theme field not parsed","description":"## Problem\nTheme field in Claude Code `settings.json` shows '(not supported)' instead of actual value.\n\n## Evidence\nConfig has `\"theme\": \"dark\"` but parser shows '(not supported)'.\n\n## Preliminary Analysis\n`extract_theme()` in `manager.rs` explicitly returns `None` for claude-code harness - the case is missing.\n\n## Research Required\n**Agent must verify**: Is this a bridle logic bug (missing implementation) or does Claude Code not actually support theme in settings.json?\n\nCheck:\n1. Does official Claude Code documentation confirm theme is a valid settings.json field?\n2. What JSON path should be used to extract it?\n3. Is `harness-locate` involved in theme extraction at all?\n\n## Test Command\n```bash\ncargo run -- profile show claude-code full-test\n```","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-29T18:22:42.477233Z","updated_at":"2025-12-29T20:53:05.901341Z","closed_at":"2025-12-29T20:53:05.901341Z","close_reason":"Added claude-code case to extract_theme() - reads theme from settings.json"}
{"id":"bridle-jb5","title":"TUI Shared Widgets: HarnessTabs \u0026 StatusBar","description":"# Shared Widgets: HarnessTabs \u0026 StatusBar\n\n**Epic**: bridle-pm8 (TUI Redesign)\n**Phase**: 2 of 5\n**Depends on**: Foundation task\n\n## Objective\nImplement the two widgets shared by both Dashboard and Card views:\n1. **HarnessTabs**: Horizontal tab bar for harness selection\n2. **StatusBar**: Bottom bar with keybindings and messages\n\n## Widget 1: HarnessTabs\n\n### Visual Design\n```\n┌─────────────────────────────────────────────────────────────┐\n│  ◀  [● Claude Code]  [+ OpenCode]  [- Goose]  ▶            │\n└─────────────────────────────────────────────────────────────┘\n```\n\n**Status Indicators**:\n- `●` = Has active profile (managed by bridle) - Green\n- `+` = Installed with config - White  \n- `-` = Binary only (no config) - Gray\n- ` ` = Not installed - Dark gray, italic\n\n### Implementation\n\n**File**: `src/tui/widgets/harness_tabs.rs`\n\n```rust\nuse ratatui::{\n    buffer::Buffer,\n    layout::Rect,\n    style::{Color, Modifier, Style},\n    text::{Line, Span},\n    widgets::{Block, Borders, Tabs, Widget},\n};\nuse harness_locate::{Harness, HarnessKind, InstallationStatus};\nuse crate::config::BridleConfig;\nuse crate::tui::theme::Theme;\n\npub struct HarnessTabs\u003c'a\u003e {\n    harnesses: \u0026'a [HarnessKind],\n    selected: usize,\n    bridle_config: \u0026'a BridleConfig,\n}\n\nimpl\u003c'a\u003e HarnessTabs\u003c'a\u003e {\n    pub fn new(\n        harnesses: \u0026'a [HarnessKind],\n        selected: usize,\n        bridle_config: \u0026'a BridleConfig,\n    ) -\u003e Self {\n        Self { harnesses, selected, bridle_config }\n    }\n    \n    fn harness_label(\u0026self, kind: HarnessKind) -\u003e (String, Style) {\n        let harness = Harness::new(kind);\n        let harness_id = harness.id();\n        \n        // Check if bridle is managing this harness\n        let has_active = self.bridle_config\n            .active_profile_for(harness_id)\n            .is_some();\n        \n        let (indicator, style) = if has_active {\n            (\"●\", Theme::HARNESS_ACTIVE)\n        } else {\n            match harness.installation_status() {\n                Ok(InstallationStatus::FullyInstalled { .. }) =\u003e (\"+\", Theme::HARNESS_INSTALLED),\n                Ok(InstallationStatus::ConfigOnly { .. }) =\u003e (\"+\", Theme::HARNESS_INSTALLED),\n                Ok(InstallationStatus::BinaryOnly { .. }) =\u003e (\"-\", Theme::HARNESS_NOT_INSTALLED),\n                _ =\u003e (\" \", Theme::HARNESS_NOT_INSTALLED),\n            }\n        };\n        \n        (format!(\"{} {}\", indicator, kind), style)\n    }\n}\n\nimpl Widget for HarnessTabs\u003c'_\u003e {\n    fn render(self, area: Rect, buf: \u0026mut Buffer) {\n        let titles: Vec\u003cLine\u003e = self.harnesses\n            .iter()\n            .map(|kind| {\n                let (label, style) = self.harness_label(*kind);\n                Line::from(Span::styled(label, style))\n            })\n            .collect();\n        \n        let tabs = Tabs::new(titles)\n            .block(Block::default()\n                .borders(Borders::ALL)\n                .title(\" Harnesses \"))\n            .select(self.selected)\n            .highlight_style(Style::default()\n                .add_modifier(Modifier::BOLD)\n                .add_modifier(Modifier::REVERSED))\n            .divider(\"│\");\n        \n        tabs.render(area, buf);\n    }\n}\n```\n\n### Keyboard Navigation\n\nUpdate `App` to handle horizontal navigation:\n- `←` / `h`: Previous harness\n- `→` / `l`: Next harness\n- Remove Tab key for pane switching (no longer needed)\n\n## Widget 2: StatusBar\n\n### Visual Design\n```\n┌─────────────────────────────────────────────────────────────┐\n│ ←→:harness  j/k:nav  Enter:switch  Space:details  ?:help   │\n└─────────────────────────────────────────────────────────────┘\n```\n\nWith message:\n```\n│ ←→:harness  j/k:nav  ...  │  Switched to 'default'        │\n```\n\n### Implementation\n\n**File**: `src/tui/widgets/status_bar.rs`\n\n```rust\nuse ratatui::{\n    buffer::Buffer,\n    layout::Rect,\n    text::{Line, Span},\n    widgets::{Paragraph, Widget},\n};\nuse crate::tui::theme::Theme;\n\npub struct StatusBar\u003c'a\u003e {\n    keybinds: \u0026'a str,\n    message: Option\u003c\u0026'a str\u003e,\n}\n\nimpl\u003c'a\u003e StatusBar\u003c'a\u003e {\n    pub fn new(keybinds: \u0026'a str) -\u003e Self {\n        Self { keybinds, message: None }\n    }\n    \n    pub fn message(mut self, msg: Option\u003c\u0026'a str\u003e) -\u003e Self {\n        self.message = msg;\n        self\n    }\n    \n    pub fn dashboard_keybinds() -\u003e \u0026'static str {\n        \"←→:harness  j/k:nav  Enter:switch  Space:details  n:new  d:del  e:edit  ?:help\"\n    }\n    \n    #[cfg(feature = \"tui-cards\")]\n    pub fn cards_keybinds() -\u003e \u0026'static str {\n        \"←→:harness  j/k:card  Enter:switch  Space:details  n:new  d:del  ?:help\"\n    }\n}\n\nimpl Widget for StatusBar\u003c'_\u003e {\n    fn render(self, area: Rect, buf: \u0026mut Buffer) {\n        let spans = if let Some(msg) = self.message {\n            vec![\n                Span::styled(self.keybinds, Theme::STATUS_KEYBIND),\n                Span::raw(\"  \"),\n                Span::styled(msg, Theme::STATUS_MESSAGE),\n            ]\n        } else {\n            vec![Span::styled(self.keybinds, Theme::STATUS_KEYBIND)]\n        };\n        \n        Paragraph::new(Line::from(spans)).render(area, buf);\n    }\n}\n```\n\n## App State Changes\n\nUpdate `App` struct in `src/tui/mod.rs`:\n\n```rust\n// Remove Pane enum (no longer needed for pane focus)\n// Keep for potential detail pane focus in dashboard\n\n// Update handle_key for horizontal harness navigation\nfn handle_normal_key(\u0026mut self, key: KeyCode) {\n    match key {\n        // Harness navigation (horizontal)\n        KeyCode::Left | KeyCode::Char('h') =\u003e self.prev_harness(),\n        KeyCode::Right | KeyCode::Char('l') =\u003e self.next_harness(),\n        \n        // Profile navigation (vertical)\n        KeyCode::Up | KeyCode::Char('k') =\u003e self.prev_profile(),\n        KeyCode::Down | KeyCode::Char('j') =\u003e self.next_profile(),\n        \n        // Actions\n        KeyCode::Enter =\u003e self.switch_to_selected(),\n        KeyCode::Char(' ') =\u003e self.toggle_details(),\n        // ... rest unchanged\n    }\n}\n```\n\n## Acceptance Criteria\n\n- [ ] HarnessTabs renders horizontally with status indicators\n- [ ] Left/Right arrows switch harness selection\n- [ ] StatusBar shows keybindings and optional message\n- [ ] Existing profile navigation still works\n- [ ] No Tab key confusion (removed pane switching)\n\n## Testing\n\n```bash\ncargo run -- tui\n# - Verify tabs render at top\n# - Press ← → to switch harnesses\n# - Verify status bar shows at bottom\n# - Verify j/k still navigates profiles\n```\n","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T17:08:10.342032Z","updated_at":"2025-12-28T19:19:10.478549Z","closed_at":"2025-12-28T19:19:10.478549Z","close_reason":"Implemented shared widgets: HarnessTabs with status indicators (●/+/-), StatusBar widget with view-mode-aware keybindings","dependencies":[{"issue_id":"bridle-jb5","depends_on_id":"bridle-hue","type":"blocks","created_at":"2025-12-28T17:10:58.42111Z","created_by":"daemon"}]}
{"id":"bridle-jm0","title":"Enhanced ProfileInfo data structures","description":"## Goal\nExtend ProfileInfo struct with extensible types for all new profile information.\n\n## Changes\n\nAdd new types in src/config/ or src/harness/:\n\n```rust\n/// Extensible MCP server info - start with name+enabled, easy to add fields later\npub struct McpServerInfo {\n    pub name: String,\n    pub enabled: bool,\n    // Future: pub transport: McpTransport, pub command: Option\u003cString\u003e, etc.\n}\n\n/// Resource summary for directory-based items (skills, commands, etc.)\npub struct ResourceSummary {\n    pub items: Vec\u003cString\u003e,\n    pub directory_exists: bool,\n}\n```\n\nUpdate ProfileInfo in src/config/manager.rs:\n\n```rust\npub struct ProfileInfo {\n    // Existing\n    pub name: String,\n    pub harness_id: String,\n    pub is_active: bool,\n    pub path: PathBuf,\n    \n    // New - replaces Vec\u003cString\u003e\n    pub mcp_servers: Vec\u003cMcpServerInfo\u003e,\n    pub skills: ResourceSummary,\n    pub commands: ResourceSummary,\n    pub plugins: Option\u003cResourceSummary\u003e,  // OpenCode only\n    pub agents: Option\u003cResourceSummary\u003e,   // OpenCode only\n    pub rules_file: Option\u003cPathBuf\u003e,\n    pub theme: Option\u003cString\u003e,             // OpenCode only\n    pub model: Option\u003cString\u003e,\n    \n    // Error tracking\n    pub extraction_errors: Vec\u003cString\u003e,    // Show what failed to parse\n}\n```\n\n## Acceptance Criteria\n- [ ] McpServerInfo struct created with name + enabled fields\n- [ ] ResourceSummary struct created with items + directory_exists\n- [ ] ProfileInfo extended with all new fields\n- [ ] Existing code compiles (may need temporary Default implementations)\n- [ ] cargo clippy passes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T11:59:38.361209Z","updated_at":"2025-12-28T12:32:11.524782Z","closed_at":"2025-12-28T12:32:11.524782Z","close_reason":"All phases complete - McpServerInfo, ResourceSummary, extended ProfileInfo"}
{"id":"bridle-jm0.1","title":"Define McpServerInfo and ResourceSummary types","description":"## Context\nAdd new data types to support richer profile information. Phase 1 of ProfileInfo enhancement.\n\n## Key Changes\n- `src/config/manager.rs` - Add McpServerInfo struct (name + enabled)\n- `src/config/manager.rs` - Add ResourceSummary struct (items + directory_exists)\n- `src/config/mod.rs` - Add re-exports\n\n## Patterns to Follow\n- See `src/harness/display.rs:4-14` for DisplayInfo pattern\n- Use `#[derive(Debug, Clone, Default)]`\n- Doc comments on struct and each field\n\n## Success Criteria\n- [ ] McpServerInfo struct with name: String, enabled: bool\n- [ ] ResourceSummary struct with items: Vec\u003cString\u003e, directory_exists: bool\n- [ ] Both re-exported from src/config/mod.rs\n- [ ] cargo check passes\n\n## References\n- Full plan: `.beads/artifacts/bridle-jm0/plan.md`\n- Research: `.beads/artifacts/bridle-jm0/research.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T12:25:50.699111Z","updated_at":"2025-12-28T12:28:09.836281Z","closed_at":"2025-12-28T12:28:09.836281Z","close_reason":"Phase 1 complete: McpServerInfo and ResourceSummary types defined and exported","dependencies":[{"issue_id":"bridle-jm0.1","depends_on_id":"bridle-jm0","type":"parent-child","created_at":"2025-12-28T12:25:50.699583Z","created_by":"daemon"}]}
{"id":"bridle-jm0.2","title":"Extend ProfileInfo with new fields","description":"## Context\nExtend ProfileInfo struct with all new fields. Phase 2 of ProfileInfo enhancement.\n\n## Key Changes\n- `src/config/manager.rs` - Add Default derive to ProfileInfo\n- `src/config/manager.rs` - Change mcp_servers to Vec\u003cMcpServerInfo\u003e\n- `src/config/manager.rs` - Add: skills, commands, plugins, agents, rules_file, theme, model, extraction_errors\n- `src/config/manager.rs` - Update show_profile() to construct with new fields (defaults for now)\n\n## Patterns to Follow\n- plugins/agents are Option\u003cResourceSummary\u003e (OpenCode only)\n- Other new fields use Default::default() temporarily\n- Convert Vec\u003cString\u003e mcp_servers to Vec\u003cMcpServerInfo\u003e with enabled: true\n\n## Success Criteria\n- [ ] ProfileInfo has all 12 fields per spec\n- [ ] show_profile() constructs ProfileInfo with new fields\n- [ ] cargo check passes\n\n## References\n- Full plan: `.beads/artifacts/bridle-jm0/plan.md`\n- Research: `.beads/artifacts/bridle-jm0/research.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T12:25:54.625432Z","updated_at":"2025-12-28T12:30:58.309918Z","closed_at":"2025-12-28T12:30:58.309918Z","close_reason":"Phase 2 complete: ProfileInfo extended with all new fields","dependencies":[{"issue_id":"bridle-jm0.2","depends_on_id":"bridle-jm0","type":"parent-child","created_at":"2025-12-28T12:25:54.628543Z","created_by":"daemon"}]}
{"id":"bridle-jm0.3","title":"Fix CLI to use McpServerInfo.name","description":"## Context\nUpdate CLI call site to handle new mcp_servers type. Phase 3 of ProfileInfo enhancement.\n\n## Key Changes\n- `src/cli/profile.rs:77` - Change `{server}` to `{server.name}`\n\n## Success Criteria\n- [ ] CLI displays MCP server names correctly\n- [ ] cargo build passes\n- [ ] cargo clippy passes\n- [ ] cargo test passes\n\n## References\n- Full plan: `.beads/artifacts/bridle-jm0/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T12:25:56.858147Z","updated_at":"2025-12-28T12:30:58.38647Z","closed_at":"2025-12-28T12:30:58.38647Z","close_reason":"Phase 3 complete: CLI updated to use server.name","dependencies":[{"issue_id":"bridle-jm0.3","depends_on_id":"bridle-jm0","type":"parent-child","created_at":"2025-12-28T12:25:56.860462Z","created_by":"daemon"}]}
{"id":"bridle-ju4","title":"Goose model extraction looks for wrong key 'model' instead of 'GOOSE_MODEL'","description":"extract_model_goose() in manager.rs looks for a 'model' key in config.yaml but Goose uses 'GOOSE_MODEL' (all caps).\n\n## Verification Steps\n\n1. Ensure bridle-ypz (YAML parse error) is fixed first - this bug is blocked by it.\n\n2. Check the test profile config:\n   ```bash\n   cat ~/.config/bridle/profiles/goose/test/config.yaml | grep -i model\n   # Should show: GOOSE_MODEL: \u003csome-model-name\u003e\n   ```\n\n3. Run profile show:\n   ```bash\n   cargo run -- profile show goose test\n   ```\n\n4. **Before fix**: Model shows '(not set)' even though GOOSE_MODEL is configured\n\n5. **After fix**: Model should display the value from GOOSE_MODEL, e.g.:\n   ```\n   Model: qwen/qwen3-coder\n   ```\n\n6. Also verify GOOSE_CLI_THEME extraction for theme field (Goose uses GOOSE_CLI_THEME not 'theme')","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-28T14:37:31.924834Z","updated_at":"2025-12-28T14:58:27.618472Z","closed_at":"2025-12-28T14:58:27.618472Z","close_reason":"Closed"}
{"id":"bridle-krm","title":"Verify Nushell integration end-to-end","description":"## Parent Epic\nbridle-xgw: Nushell-friendly structured output for CLI display commands\n\n## Objective\nFinal verification that all JSON output works correctly and auto-detection functions properly.\n\n## Verification Checklist\n\n### 1. JSON Validity\n```bash\n# All commands should produce valid JSON\ncargo run -- -o json status | jq . \u003e /dev/null \u0026\u0026 echo \"✓ status JSON valid\"\ncargo run -- -o json profile list opencode | jq . \u003e /dev/null \u0026\u0026 echo \"✓ profile list JSON valid\"\ncargo run -- -o json profile show opencode test | jq . \u003e /dev/null \u0026\u0026 echo \"✓ profile show JSON valid\"\n```\n\n### 2. Auto-Detection\n```bash\n# Simulate Nushell environment\nNU_VERSION=0.99.0 cargo run -- status | head -1  # Should start with { or [\nNU_VERSION=0.99.0 cargo run -- --output text status | head -1  # Should be text\n\n# Without NU_VERSION (normal shell)\nunset NU_VERSION\ncargo run -- status | head -1  # Should be text (e.g., \"Harness Status:\")\n```\n\n### 3. Flag Variations\n```bash\n# Global flag positions\ncargo run -- --output json status\ncargo run -- -o json status\ncargo run -- status --output json  # Should also work (global)\n\n# All three formats\ncargo run -- -o text status\ncargo run -- -o json status  \ncargo run -- -o auto status\n```\n\n### 4. Edge Cases\n```bash\n# Empty results\ncargo run -- -o json profile list nonexistent-harness  # Should error gracefully\ncargo run -- -o json profile show opencode nonexistent  # Should error gracefully\n\n# Profiles with extraction errors\n# (verify extraction_errors field is populated if parsing fails)\n```\n\n### 5. jq Integration Examples\n```bash\n# Status queries\ncargo run -- -o json status | jq '.harnesses[] | select(.installed) | .name'\ncargo run -- -o json status | jq '.active_profiles | map(.harness)'\n\n# Profile queries\ncargo run -- -o json profile list opencode | jq '.[].name'\ncargo run -- -o json profile list opencode | jq '.[] | select(.is_active)'\ncargo run -- -o json profile show opencode test | jq '.mcp_servers[].name'\n```\n\n### 6. Quality Gates\n```bash\ncargo fmt -- --check\ncargo clippy -- -D warnings\ncargo test\n```\n\n## Success Criteria\n- [ ] All JSON outputs are valid (parseable by jq)\n- [ ] NU_VERSION detection works correctly\n- [ ] --output flag overrides auto-detection\n- [ ] Error cases produce appropriate error messages (not invalid JSON)\n- [ ] All quality gates pass\n- [ ] Help text shows --output flag with description\n\n## Dependencies\n- Depends on: bridle-apb (status JSON)\n- Depends on: bridle-lfo (profile list JSON)\n- Depends on: bridle-x1d (profile show JSON)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:35:41.54899Z","updated_at":"2025-12-29T21:45:38.478299Z","closed_at":"2025-12-29T21:45:38.478299Z","close_reason":"Removed per user request","dependencies":[{"issue_id":"bridle-krm","depends_on_id":"bridle-apb","type":"blocks","created_at":"2025-12-28T22:36:03.832417Z","created_by":"daemon"},{"issue_id":"bridle-krm","depends_on_id":"bridle-lfo","type":"blocks","created_at":"2025-12-28T22:36:03.907671Z","created_by":"daemon"},{"issue_id":"bridle-krm","depends_on_id":"bridle-x1d","type":"blocks","created_at":"2025-12-28T22:36:03.984387Z","created_by":"daemon"}]}
{"id":"bridle-lfo","title":"Add JSON output to bridle profile list command","description":"## Parent Epic\nbridle-xgw: Nushell-friendly structured output for CLI display commands\n\n## Objective\nRefactor `bridle profile list \u003charness\u003e` to support JSON output.\n\n## File to Modify: src/cli/profile.rs\n\n### Current Flow\n`list_profiles()` calls `ProfileManager::list()` which returns `Vec\u003cProfileInfo\u003e`, then prints each profile with println!.\n\n### Refactored list_profiles()\n\n```rust\nuse crate::cli::output::{ResolvedFormat, output_list};\n\npub fn list_profiles(harness: \u0026str, format: ResolvedFormat) -\u003e Result\u003c()\u003e {\n    let harness_kind = HarnessKind::from_id(harness)?;\n    let manager = ProfileManager::new(harness_kind);\n    let profiles = manager.list()?;\n\n    if profiles.is_empty() {\n        // Empty case - still valid JSON\n        output_list(\u0026profiles, format, |_| {\n            println!(\"No profiles found for {}\", harness_kind.display_name());\n        });\n        return Ok(());\n    }\n\n    output_list(\u0026profiles, format, |profiles| {\n        println!(\"\\nProfiles for {}:\", harness_kind.display_name());\n        println!(\"{:-\u003c50}\", \"\");\n        for profile in profiles {\n            let active = if profile.is_active { \" (active)\" } else { \"\" };\n            println!(\"  • {}{}\", profile.name, active);\n        }\n    });\n\n    Ok(())\n}\n```\n\n### JSON Output Example\n\n```json\n[\n  {\n    \"name\": \"test\",\n    \"harness_id\": \"opencode\",\n    \"is_active\": true,\n    \"path\": \"/Users/d0/.config/bridle/profiles/opencode/test\",\n    \"mcp_servers\": [{\"name\": \"filesystem\", \"enabled\": true}],\n    \"skills\": {\"items\": [\"rust\"], \"directory_exists\": true},\n    \"commands\": {\"items\": [], \"directory_exists\": false},\n    \"plugins\": {\"items\": [], \"directory_exists\": false},\n    \"agents\": {\"items\": [], \"directory_exists\": false},\n    \"rules_file\": null,\n    \"theme\": \"dark\",\n    \"model\": \"claude-sonnet-4-20250514\",\n    \"extraction_errors\": []\n  },\n  {\n    \"name\": \"minimal\",\n    \"harness_id\": \"opencode\",\n    \"is_active\": false,\n    ...\n  }\n]\n```\n\n### Nushell Usage Examples\n\n```bash\n# List all profiles with active status\nbridle profile list opencode | from json | select name is_active\n\n# Find active profile\nbridle profile list claude | from json | where is_active == true | get name\n\n# Count MCP servers across profiles\nbridle profile list opencode | from json | each { |p| $p.mcp_servers | length } | math sum\n\n# Filter profiles with specific plugin\nbridle profile list opencode | from json | where (\"some-plugin\" in $it.plugins.items)\n```\n\n## Verification\n```bash\ncargo run -- profile list opencode             # Text output\ncargo run -- -o json profile list opencode     # JSON array\ncargo run -- -o json profile list opencode | jq '.[0].name'\n```\n\n## Dependencies\n- Depends on: bridle-dsh (Serialize on ProfileInfo)\n- Depends on: bridle-nfd (global --output flag)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:35:06.140913Z","updated_at":"2025-12-29T21:56:38.925631Z","closed_at":"2025-12-29T21:56:38.925631Z","close_reason":"Added JSON output support to profile list using output_list with ProfileListEntry struct","dependencies":[{"issue_id":"bridle-lfo","depends_on_id":"bridle-nfd","type":"blocks","created_at":"2025-12-28T22:36:03.532922Z","created_by":"daemon"},{"issue_id":"bridle-lfo","depends_on_id":"bridle-dsh","type":"blocks","created_at":"2025-12-28T22:36:03.608823Z","created_by":"daemon"}]}
{"id":"bridle-mon","title":"Document harness config schemas for profile parsing","description":"Create documentation capturing the actual config format for each harness to guide profile parsing implementation. See research findings from profile parsing bug investigation.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-28T14:37:58.257442Z","updated_at":"2025-12-28T15:56:05.826509Z","closed_at":"2025-12-28T15:56:05.826509Z","close_reason":"Documentation already exists in AGENTS.md (lines 327-400): test profile locations, verification commands, config structures for all three harnesses, and known issues table. Code implementation matches documented schemas."}
{"id":"bridle-nfd","title":"Add global --output flag to CLI","description":"## Parent Epic\nbridle-xgw: Nushell-friendly structured output for CLI display commands\n\n## Objective\nAdd global `--output` / `-o` flag to the main CLI struct so it's available to all subcommands.\n\n## File to Modify: src/main.rs\n\n### Current State\n```rust\n#[derive(Parser)]\n#[command(author, version, about, long_about = None)]\nstruct Cli {\n    #[command(subcommand)]\n    command: Commands,\n}\n```\n\n### Target State\n```rust\nuse crate::cli::output::OutputFormat;\n\n#[derive(Parser)]\n#[command(author, version, about, long_about = None)]\nstruct Cli {\n    /// Output format: text, json, or auto (default: auto)\n    /// \n    /// Auto-detects Nushell and uses JSON, otherwise text.\n    #[arg(long, short = 'o', default_value = \"auto\", global = true)]\n    output: OutputFormat,\n\n    #[command(subcommand)]\n    command: Commands,\n}\n```\n\n## Passing Format to Commands\n\nUpdate command dispatch to pass the resolved format:\n\n```rust\nfn main() -\u003e Result\u003c()\u003e {\n    let cli = Cli::parse();\n    let format = cli.output.resolve();\n\n    match cli.command {\n        Commands::Status =\u003e cli::status::display_status(format)?,\n        Commands::Profile(cmd) =\u003e cli::profile::handle_command(cmd, format)?,\n        // ... other commands (may ignore format for now)\n    }\n    Ok(())\n}\n```\n\n## Command Signature Updates\n\nCommands that support output format will need updated signatures:\n\n```rust\n// status.rs\npub fn display_status(format: ResolvedFormat) -\u003e Result\u003c()\u003e\n\n// profile.rs  \npub fn handle_command(cmd: ProfileCommands, format: ResolvedFormat) -\u003e Result\u003c()\u003e\npub fn list_profiles(harness: \u0026str, format: ResolvedFormat) -\u003e Result\u003c()\u003e\npub fn show_profile(harness: \u0026str, name: \u0026str, format: ResolvedFormat) -\u003e Result\u003c()\u003e\n```\n\n## Usage Examples\n\n```bash\n# Global flag works with any subcommand\nbridle --output json status\nbridle -o json profile list claude\nbridle profile show opencode test --output json\n\n# Short form\nbridle -o json status\n```\n\n## Verification\n```bash\ncargo run -- --help  # Should show --output flag\ncargo run -- -o json status  # Should output JSON\ncargo run -- status --output text  # Should output text\n```\n\n## Dependencies\n- Depends on: bridle-3do (OutputFormat enum)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:34:20.60064Z","updated_at":"2025-12-29T21:47:53.638887Z","closed_at":"2025-12-29T21:47:53.638887Z","close_reason":"Added global --output flag to Cli struct, resolves format in main(), passes to status/profile commands","dependencies":[{"issue_id":"bridle-nfd","depends_on_id":"bridle-3do","type":"blocks","created_at":"2025-12-28T22:36:03.382004Z","created_by":"daemon"}]}
{"id":"bridle-osa","title":"Fix TUI not redrawing after external editor exits","description":"When editing a profile/config through the TUI and exiting the external editor ($EDITOR), the TUI fails to restore terminal state and redraw. Screen shows whatever was behind the terminal with only 'Edited X' message at bottom. Reproducible with :q in vim.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-28T16:35:27.743552Z","updated_at":"2025-12-28T16:41:15.720211Z","closed_at":"2025-12-28T16:41:15.720211Z","close_reason":"Fixed by adding needs_full_redraw flag that triggers terminal.clear() after editor exits"}
{"id":"bridle-pkd","title":"Directory resource extractors","description":"## Goal\nAdd helper methods to extract skills, commands, plugins, agents from profile directories using get-harness APIs.\n\n## Dependencies\n- Depends on: bridle-jm0 (Enhanced ProfileInfo data structures)\n\n## Changes\n\nAdd extraction helpers (in src/config/manager.rs or new extractor module):\n\n```rust\n/// Extract resource summary from a DirectoryResource\nfn extract_resource_summary(dir: \u0026DirectoryResource) -\u003e ResourceSummary {\n    // List files in directory, return names\n    // Handle directory not existing gracefully\n}\n\nimpl ProfileManager {\n    pub fn extract_skills(\u0026self, harness: \u0026Harness, scope: Scope) -\u003e ResourceSummary {\n        let dir = harness.skills(scope);\n        extract_resource_summary(\u0026dir)\n    }\n    \n    pub fn extract_commands(\u0026self, harness: \u0026Harness, scope: Scope) -\u003e ResourceSummary {\n        let dir = harness.commands(scope);\n        extract_resource_summary(\u0026dir)\n    }\n    \n    pub fn extract_plugins(\u0026self, harness: \u0026Harness, scope: Scope) -\u003e Option\u003cResourceSummary\u003e {\n        // Only for OpenCode - returns None for other harnesses\n        harness.plugins(scope).map(|dir| extract_resource_summary(\u0026dir))\n    }\n    \n    pub fn extract_agents(\u0026self, harness: \u0026Harness, scope: Scope) -\u003e Option\u003cResourceSummary\u003e {\n        // Only for OpenCode - returns None for other harnesses\n        harness.agents(scope).map(|dir| extract_resource_summary(\u0026dir))\n    }\n    \n    pub fn extract_rules_file(\u0026self, harness: \u0026Harness, scope: Scope) -\u003e Option\u003cPathBuf\u003e {\n        let rules = harness.rules(scope);\n        if rules.exists { Some(rules.path) } else { None }\n    }\n}\n```\n\n## get-harness API Reference\n- `harness.skills(scope)` -\u003e DirectoryResource\n- `harness.commands(scope)` -\u003e DirectoryResource  \n- `harness.plugins(scope)` -\u003e Option\u003cDirectoryResource\u003e (OpenCode only)\n- `harness.agents(scope)` -\u003e Option\u003cDirectoryResource\u003e (OpenCode only)\n- `harness.rules(scope)` -\u003e DirectoryResource\n\n## Acceptance Criteria\n- [ ] extract_resource_summary helper implemented\n- [ ] extract_skills() works for all harnesses\n- [ ] extract_commands() works for all harnesses\n- [ ] extract_plugins() returns Some for OpenCode, None for others\n- [ ] extract_agents() returns Some for OpenCode, None for others\n- [ ] extract_rules_file() returns path if rules file exists\n- [ ] Graceful handling when directories don't exist\n- [ ] cargo test passes\n- [ ] cargo clippy passes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T11:59:54.63998Z","updated_at":"2025-12-28T13:26:25.467262Z","closed_at":"2025-12-28T13:26:25.467262Z","close_reason":"All phases complete - tests passing, coach approved","dependencies":[{"issue_id":"bridle-pkd","depends_on_id":"bridle-jm0","type":"blocks","created_at":"2025-12-28T12:00:46.788729Z","created_by":"daemon"}]}
{"id":"bridle-pm8","title":"TUI Redesign: Dashboard \u0026 Card Views","description":"# TUI Redesign Epic\n\n## Problem Statement\nThe current TUI wastes space and hides information:\n- Right 2/3 of screen empty when no profile expanded\n- Users must expand to see model, MCPs, plugins, theme\n- Vertical harness list takes 30% width for only 3 items\n- No visual hierarchy for active profile\n- No at-a-glance summary for comparing profiles\n\n## Solution\nImplement two view modes:\n1. **Dashboard View** (default): Three-pane layout with always-visible details\n2. **Card View** (feature-gated): Grid of profile cards with inline summaries\n\n## Key Design Decisions\n| Decision | Choice |\n|----------|--------|\n| Default view | Dashboard |\n| Card view | Behind `tui-cards` Cargo feature |\n| Enter key | Switch to profile (both views) |\n| Space key | Show/toggle details |\n| Help modal | Single modal, adapts to view |\n| View config | In config.toml, user edits directly |\n| View toggle hotkey | None - config file only |\n\n## Keyboard Shortcuts (Both Views)\n| Key | Action |\n|-----|--------|\n| ←/→ or h/l | Switch harness |\n| ↑/↓ or j/k | Navigate profiles |\n| Enter | Switch to selected profile |\n| Space | Show details |\n| n | New profile |\n| d | Delete profile |\n| e | Edit profile |\n| r | Refresh |\n| ? | Help |\n| q/Esc | Quit |\n\n## Architecture\n```\nsrc/tui/\n├── mod.rs                 # Entry point, App, event loop\n├── theme.rs               # Shared colors/styles  \n├── views/\n│   ├── mod.rs             # ViewMode enum, View trait\n│   ├── dashboard.rs       # Three-pane dashboard\n│   └── cards.rs           # Card grid (feature-gated)\n└── widgets/\n    ├── mod.rs\n    ├── harness_tabs.rs    # Horizontal harness tabs\n    ├── profile_table.rs   # Table widget for dashboard\n    ├── detail_pane.rs     # Right pane for dashboard\n    ├── profile_card.rs    # Single card (feature-gated)\n    └── status_bar.rs      # Bottom status bar\n```\n\n## Research Findings\n\n### Ratatui Widgets Used\n- **Tabs**: Built-in, for horizontal harness navigation with `select()`, `highlight_style()`, `divider()`\n- **Table**: Built-in, for profile list with columns\n- **Block**: For bordered containers with `bordered()`, `title()`, `padding()`\n- **Layout**: Using `Constraint::Length/Fill/Percentage` for responsive layouts\n\n### Third-Party Widgets Evaluated\n- **tui-scrollview**: For scrollable detail pane (optional, may not need)\n- **tui-cards** (joshka/tui-widgets): Evaluated but using custom implementation\n- **tui-tree-widget**: Not needed, flat MCP list sufficient\n\n### Layout Patterns\n```rust\n// Vertical split\nLayout::vertical([\n    Constraint::Length(3),  // tabs\n    Constraint::Fill(1),    // main\n    Constraint::Length(1),  // status\n])\n\n// Horizontal split for main area\nLayout::horizontal([\n    Constraint::Percentage(40),  // profiles\n    Constraint::Percentage(60),  // details\n])\n```\n\n## Dashboard Layout\n```\n┌─ Harness Tabs ──────────────────────────────────────────────┐\n│  [● Claude Code]  [+ OpenCode]  [- Goose]                   │\n├─ Profiles ───────────────────┬─ Details ────────────────────┤\n│ ● default    sonnet-4  3 MCP │ Profile: default             │\n│   test       sonnet-4  0 MCP │ Model: claude-sonnet-4       │\n│                              │ Theme: —                     │\n│                              │ MCP Servers (3)              │\n│                              │  ✓ filesystem                │\n│                              │  ✓ github                    │\n│                              │  ✗ postgres                  │\n│                              │ Resources                    │\n│                              │  Skills: 5    Commands: 3    │\n├─────────────────────────────┴──────────────────────────────┤\n│ q:quit  ←→:harness  j/k:profile  Enter:switch  n:new  ?    │\n└─────────────────────────────────────────────────────────────┘\n```\n\n## Card Layout (Feature-Gated)\n```\n┌─ Harness Tabs ──────────────────────────────────────────────┐\n│  [● Claude Code]  [+ OpenCode]  [- Goose]                   │\n├─────────────────────────────────────────────────────────────┤\n│  ┌─ default ● ───────────┐   ┌─ test ────────────────────┐ │\n│  │ claude-sonnet-4       │   │ claude-sonnet-4          │ │\n│  │ MCP: filesystem,      │   │ MCP: (none)              │ │\n│  │      github, +1       │   │ Skills: 2                │ │\n│  │ Skills: 5  Cmds: 3    │   │ Commands: 0              │ │\n│  └───────────────────────┘   └──────────────────────────┘ │\n├────────────────────────────────────────────────────────────┤\n│ q:quit  ←→:harness  j/k:card  Enter:switch  n:new  ?      │\n└────────────────────────────────────────────────────────────┘\n```\n","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-28T17:07:17.870792Z","updated_at":"2025-12-29T22:03:43.165346Z","closed_at":"2025-12-29T22:03:43.165346Z","close_reason":"Closed"}
{"id":"bridle-pn0","title":"Enhanced CLI profile display","description":"## Goal\nUpdate CLI output to display all new profile information with error details.\n\n## Dependencies\n- Depends on: bridle-jm3 (Wire up extraction)\n\n## Changes\n\nUpdate src/cli/profile.rs show_profile() output:\n\n```\nProfile: my-profile\nHarness: OpenCode\nStatus: Active\nPath: /Users/me/.config/opencode/profiles/my-profile\n\nTheme: catppuccin\nModel: claude-sonnet-4\n\nMCP Servers (3):\n  ✓ filesystem\n  ✓ github  \n  ✗ postgres (disabled)\n\nSkills (5):\n  code-review, testing, refactor, docs, security\n\nCommands (3):\n  /commit, /review, /deploy\n\nPlugins (2):\n  lsp-helper, git-tools\n\nAgents (1):\n  custom-agent\n\nRules: AGENTS.md\n\nErrors:\n  ⚠ Theme: Failed to parse opencode.jsonc - invalid JSON\n```\n\n## Display Rules\n- Theme: Show value or \"(not supported)\" for Claude/Goose\n- Model: Show value or omit if not configured\n- MCP Servers: ✓ for enabled, ✗ for disabled, show count in header\n- Resources (Skills/Commands/Plugins/Agents): Show count + comma-separated list\n- Plugins/Agents: Show \"(not supported)\" for Claude/Goose\n- Rules: Show filename if present, omit section if no rules\n- Errors: Only show section if extraction_errors is non-empty, use ⚠ prefix\n\n## Acceptance Criteria\n- [ ] All new fields displayed in CLI output\n- [ ] Enabled/disabled indicators for MCP servers\n- [ ] \"(not supported)\" shown for harness-specific features\n- [ ] Errors section shows extraction failures\n- [ ] Clean formatting, consistent with existing CLI style\n- [ ] cargo clippy passes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T12:00:21.833894Z","updated_at":"2025-12-28T14:25:43.75079Z","closed_at":"2025-12-28T14:25:43.75079Z","close_reason":"Enhanced profile display implemented - all verification passing","dependencies":[{"issue_id":"bridle-pn0","depends_on_id":"bridle-i0u","type":"blocks","created_at":"2025-12-28T12:00:47.224524Z","created_by":"daemon"}]}
{"id":"bridle-pp6","title":"AmpCode MCP parsing fails with 'Config missing amp.mcpServers'","description":"harness-locate's parse_mcp_servers fails for AmpCode even when amp.mcpServers exists in config. Discovered during bridle-qt4 implementation.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-28T20:18:05.045714Z","updated_at":"2025-12-28T21:50:01.669368Z","closed_at":"2025-12-28T21:50:01.669368Z","close_reason":"Fixed in harness-locate 0.2.1"}
{"id":"bridle-qt4","title":"Add full AmpCode harness support to CLI and TUI","description":"Implement AmpCode support throughout bridle: harness ID mapping, CLI aliases, config extraction, TUI display. harness-locate 0.2.0 already has HarnessKind::AmpCode - this wires it into bridle.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-28T20:00:46.549582Z","updated_at":"2025-12-28T21:50:01.564095Z","closed_at":"2025-12-28T21:50:01.564095Z","close_reason":"Implemented full AmpCode harness support"}
{"id":"bridle-s70","title":"TUI Card View: ProfileCard, CardGrid (Feature-Gated)","description":"# Card View Implementation (Feature-Gated)\n\n**Epic**: bridle-pm8 (TUI Redesign)\n**Phase**: 4 of 5\n**Depends on**: bridle-hue (Foundation), bridle-jb5 (Shared Widgets)\n**Feature Flag**: `tui-cards`\n\n## Objective\nImplement the card-based grid view as an alternative TUI experience, behind a Cargo feature flag.\n\n## Enabling the Feature\n\n```bash\n# Compile with card view support\ncargo build --features tui-cards\n\n# Enable in config (~/.config/bridle/config.toml)\n[tui]\nview = \"cards\"\n```\n\n## Layout Structure\n\n```\n┌─ Harness Tabs ──────────────────────────────────────────────┐  Length(3)\n│  [● Claude Code]  [+ OpenCode]  [- Goose]                   │\n├─────────────────────────────────────────────────────────────┤\n│                                                             │\n│  ┌─ default ● ───────────┐   ┌─ test ────────────────────┐ │\n│  │ claude-sonnet-4       │   │ claude-sonnet-4          │ │\n│  │                       │   │                          │ │\n│  │ MCP: filesystem,      │   │ MCP: (none)              │ │  Fill(1)\n│  │      github, +1       │   │                          │ │\n│  │                       │   │ Skills: 2                │ │\n│  │ Skills: 5  Cmds: 3    │   │ Commands: 0              │ │\n│  └───────────────────────┘   └──────────────────────────┘ │\n│                                                            │\n│  ┌─ + New Profile ───────┐                                │\n│  │      Press 'n'        │                                │\n│  └───────────────────────┘                                │\n├────────────────────────────────────────────────────────────┤\n│ ←→:harness  j/k:card  Enter:switch  Space:details  ?      │  Length(1)\n└────────────────────────────────────────────────────────────┘\n```\n\n## Widget 1: ProfileCard\n\n**File**: `src/tui/widgets/profile_card.rs`\n\n### Card Dimensions\n- Width: Dynamic (terminal width / 2 or 3, min 30 chars)\n- Height: 8 lines (fixed)\n\n### Card Content Layout\n```\n┌─ {name} {●} ─────────────┐  Line 0: Border + title\n│ {model}                  │  Line 1: Model name\n│                          │  Line 2: Theme (if set) or blank\n│ MCP: {s1}, {s2}, +N      │  Line 3: MCP servers (truncated)\n│                          │  Line 4: blank\n│ Skills: N   Cmds: N      │  Line 5: Resource row 1\n│ Plugins: N  Agents: N    │  Line 6: Resource row 2\n└──────────────────────────┘  Line 7: Border\n```\n\n### Implementation\n\n```rust\n#![cfg(feature = \"tui-cards\")]\n\nuse ratatui::{\n    buffer::Buffer,\n    layout::Rect,\n    style::{Color, Modifier, Style},\n    text::{Line, Span},\n    widgets::{Block, Borders, Paragraph, Widget},\n};\nuse crate::config::ProfileInfo;\nuse crate::tui::theme::Theme;\n\npub struct ProfileCard\u003c'a\u003e {\n    profile: \u0026'a ProfileInfo,\n    is_selected: bool,\n}\n\nimpl\u003c'a\u003e ProfileCard\u003c'a\u003e {\n    pub fn new(profile: \u0026'a ProfileInfo, is_selected: bool) -\u003e Self {\n        Self { profile, is_selected }\n    }\n    \n    fn format_mcp_servers(\u0026self, max_width: usize) -\u003e String {\n        if self.profile.mcp_servers.is_empty() {\n            return \"(none)\".to_string();\n        }\n        \n        let enabled: Vec\u003c\u0026str\u003e = self.profile.mcp_servers\n            .iter()\n            .filter(|s| s.enabled)\n            .map(|s| s.name.as_str())\n            .collect();\n        \n        if enabled.is_empty() {\n            return \"(all disabled)\".to_string();\n        }\n        \n        let mut result = String::new();\n        let mut remaining = enabled.len();\n        \n        for (i, name) in enabled.iter().enumerate() {\n            let addition = if i == 0 {\n                name.to_string()\n            } else {\n                format!(\", {}\", name)\n            };\n            \n            // Check if adding this would exceed width\n            if result.len() + addition.len() + 5 \u003e max_width \u0026\u0026 remaining \u003e 1 {\n                result.push_str(\u0026format!(\", +{}\", remaining));\n                break;\n            }\n            \n            result.push_str(\u0026addition);\n            remaining -= 1;\n        }\n        \n        result\n    }\n    \n    fn title(\u0026self) -\u003e String {\n        let marker = if self.profile.is_active { \" ●\" } else { \"\" };\n        format!(\"{}{}\", self.profile.name, marker)\n    }\n}\n\nimpl Widget for ProfileCard\u003c'_\u003e {\n    fn render(self, area: Rect, buf: \u0026mut Buffer) {\n        let border_style = if self.is_selected {\n            Style::default().fg(Color::Cyan).add_modifier(Modifier::BOLD)\n        } else if self.profile.is_active {\n            Style::default().fg(Color::Green)\n        } else {\n            Style::default().fg(Color::DarkGray)\n        };\n        \n        let title_style = if self.profile.is_active {\n            Theme::PROFILE_ACTIVE\n        } else {\n            Style::default()\n        };\n        \n        let block = Block::default()\n            .title(Span::styled(format!(\" {} \", self.title()), title_style))\n            .borders(Borders::ALL)\n            .border_style(border_style);\n        \n        let inner = block.inner(area);\n        block.render(area, buf);\n        \n        // Content lines\n        let mut lines = Vec::new();\n        \n        // Line 1: Model\n        let model = self.profile.model.as_deref()\n            .map(|m| m.split('/').last().unwrap_or(m))\n            .unwrap_or(\"—\");\n        lines.push(Line::styled(model.to_string(), Theme::SECTION_CONTENT));\n        \n        // Line 2: Theme or blank\n        if let Some(ref theme) = self.profile.theme {\n            lines.push(Line::styled(format!(\"Theme: {}\", theme), Theme::SECTION_CONTENT));\n        } else {\n            lines.push(Line::raw(\"\"));\n        }\n        \n        // Line 3: MCP servers\n        let mcp_str = self.format_mcp_servers(inner.width as usize - 6);\n        lines.push(Line::from(vec![\n            Span::raw(\"MCP: \"),\n            Span::styled(mcp_str, Theme::SECTION_CONTENT),\n        ]));\n        \n        // Line 4: blank\n        lines.push(Line::raw(\"\"));\n        \n        // Line 5: Skills \u0026 Commands\n        let skills = self.profile.skills.items.len();\n        let commands = self.profile.commands.items.len();\n        lines.push(Line::from(vec![\n            Span::raw(\"Skills: \"),\n            Span::styled(format!(\"{:\u003c3}\", skills), Theme::SECTION_CONTENT),\n            Span::raw(\" Cmds: \"),\n            Span::styled(format!(\"{}\", commands), Theme::SECTION_CONTENT),\n        ]));\n        \n        // Line 6: Plugins \u0026 Agents (if applicable)\n        if let Some(ref plugins) = self.profile.plugins {\n            let agents = self.profile.agents.as_ref()\n                .map(|a| a.items.len())\n                .unwrap_or(0);\n            lines.push(Line::from(vec![\n                Span::raw(\"Plugins: \"),\n                Span::styled(format!(\"{:\u003c3}\", plugins.items.len()), Theme::SECTION_CONTENT),\n                Span::raw(\"Agents: \"),\n                Span::styled(\n                    if agents \u003e 0 { format!(\"{}\", agents) } else { \"—\".to_string() },\n                    Theme::SECTION_CONTENT\n                ),\n            ]));\n        }\n        \n        Paragraph::new(lines).render(inner, buf);\n    }\n}\n\n/// \"New Profile\" placeholder card\npub struct NewProfileCard {\n    is_selected: bool,\n}\n\nimpl NewProfileCard {\n    pub fn new(is_selected: bool) -\u003e Self {\n        Self { is_selected }\n    }\n}\n\nimpl Widget for NewProfileCard {\n    fn render(self, area: Rect, buf: \u0026mut Buffer) {\n        let border_style = if self.is_selected {\n            Style::default().fg(Color::Yellow).add_modifier(Modifier::BOLD)\n        } else {\n            Style::default().fg(Color::DarkGray)\n        };\n        \n        let block = Block::default()\n            .title(\" + New Profile \")\n            .borders(Borders::ALL)\n            .border_style(border_style);\n        \n        let inner = block.inner(area);\n        block.render(area, buf);\n        \n        let text = Paragraph::new(\"Press 'n'\")\n            .style(Style::default().fg(Color::DarkGray))\n            .alignment(ratatui::layout::Alignment::Center);\n        \n        // Center vertically\n        let y_offset = inner.height.saturating_sub(1) / 2;\n        let centered = Rect::new(inner.x, inner.y + y_offset, inner.width, 1);\n        text.render(centered, buf);\n    }\n}\n```\n\n## Widget 2: CardGrid\n\n**File**: `src/tui/widgets/card_grid.rs` (or inline in cards.rs)\n\n```rust\n#![cfg(feature = \"tui-cards\")]\n\nuse ratatui::{\n    layout::{Constraint, Layout, Rect},\n    Frame,\n};\nuse crate::config::ProfileInfo;\nuse super::{ProfileCard, NewProfileCard};\n\npub struct CardGrid\u003c'a\u003e {\n    profiles: \u0026'a [ProfileInfo],\n    selected: Option\u003cusize\u003e,\n}\n\nimpl\u003c'a\u003e CardGrid\u003c'a\u003e {\n    pub fn new(profiles: \u0026'a [ProfileInfo], selected: Option\u003cusize\u003e) -\u003e Self {\n        Self { profiles, selected }\n    }\n    \n    /// Calculate number of columns based on terminal width\n    fn columns_for_width(width: u16) -\u003e usize {\n        match width {\n            0..=60 =\u003e 1,\n            61..=100 =\u003e 2,\n            _ =\u003e 3,\n        }\n    }\n    \n    pub fn render(\u0026self, frame: \u0026mut Frame, area: Rect) {\n        let cols = Self::columns_for_width(area.width);\n        let card_height = 8u16;\n        \n        // Include \"New Profile\" card at the end\n        let total_items = self.profiles.len() + 1;\n        let rows_needed = (total_items + cols - 1) / cols;\n        \n        // Create row constraints\n        let row_constraints: Vec\u003cConstraint\u003e = (0..rows_needed)\n            .map(|_| Constraint::Length(card_height))\n            .chain(std::iter::once(Constraint::Fill(1))) // Remaining space\n            .collect();\n        \n        let row_areas = Layout::vertical(row_constraints).split(area);\n        \n        // Column constraints\n        let col_constraints: Vec\u003cConstraint\u003e = (0..cols)\n            .map(|_| Constraint::Ratio(1, cols as u32))\n            .collect();\n        \n        let mut item_idx = 0;\n        for (row_idx, row_area) in row_areas.iter().take(rows_needed).enumerate() {\n            let col_areas = Layout::horizontal(\u0026col_constraints).split(*row_area);\n            \n            for col_area in col_areas.iter() {\n                if item_idx \u003c self.profiles.len() {\n                    let is_selected = self.selected == Some(item_idx);\n                    let card = ProfileCard::new(\u0026self.profiles[item_idx], is_selected);\n                    frame.render_widget(card, *col_area);\n                } else if item_idx == self.profiles.len() {\n                    // \"New Profile\" card\n                    let is_selected = self.selected == Some(item_idx);\n                    let card = NewProfileCard::new(is_selected);\n                    frame.render_widget(card, *col_area);\n                }\n                item_idx += 1;\n            }\n        }\n    }\n}\n```\n\n## Widget 3: CardView Assembly\n\n**File**: `src/tui/views/cards.rs`\n\n```rust\n#![cfg(feature = \"tui-cards\")]\n\nuse ratatui::{\n    layout::{Constraint, Layout},\n    Frame,\n};\nuse crate::tui::{App, widgets::{HarnessTabs, CardGrid, StatusBar}};\n\npub struct CardView;\n\nimpl CardView {\n    pub fn render(frame: \u0026mut Frame, app: \u0026mut App) {\n        let [tabs_area, grid_area, status_area] = Layout::vertical([\n            Constraint::Length(3),\n            Constraint::Fill(1),\n            Constraint::Length(1),\n        ]).areas(frame.area());\n        \n        // Render harness tabs (shared widget)\n        let tabs = HarnessTabs::new(\n            \u0026app.harnesses,\n            app.harness_state.selected().unwrap_or(0),\n            \u0026app.bridle_config,\n        );\n        frame.render_widget(tabs, tabs_area);\n        \n        // Render card grid\n        let grid = CardGrid::new(\u0026app.profiles, app.card_selection);\n        grid.render(frame, grid_area);\n        \n        // Render status bar\n        let status = StatusBar::new(StatusBar::cards_keybinds())\n            .message(app.status_message.as_deref());\n        frame.render_widget(status, status_area);\n    }\n}\n```\n\n## App State Changes\n\nAdd card-specific state:\n\n```rust\npub struct App {\n    // ... existing fields ...\n    \n    #[cfg(feature = \"tui-cards\")]\n    card_selection: Option\u003cusize\u003e,  // Index including \"New\" card\n}\n```\n\n## Navigation in Card View\n\nGrid-aware navigation:\n- `j`: Move down one row (add columns to index)\n- `k`: Move up one row (subtract columns)\n- Selection wraps at boundaries\n- \"New Profile\" card is selectable, Enter on it triggers create flow\n\n## Acceptance Criteria\n\n- [ ] Only compiles when `--features tui-cards` enabled\n- [ ] Cards render in 1-3 column grid based on terminal width\n- [ ] Selected card has cyan border\n- [ ] Active profile card has green border/marker\n- [ ] MCP servers truncate with \"+N\" for overflow\n- [ ] \"New Profile\" placeholder card at end\n- [ ] j/k navigation is row-aware\n- [ ] Enter switches profile (or triggers create on New card)\n- [ ] Space shows detail modal (popup)\n\n## Testing\n\n```bash\n# Build with feature\ncargo build --features tui-cards\n\n# Set config\necho '[tui]\nview = \"cards\"' \u003e\u003e ~/.config/bridle/config.toml\n\n# Run\ncargo run --features tui-cards -- tui\n\n# Verify:\n# - Cards render in grid\n# - Resize terminal to see column changes\n# - Navigate with j/k\n# - Enter switches profile\n```\n","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-28T17:10:03.642974Z","updated_at":"2025-12-28T19:23:34.139821Z","closed_at":"2025-12-28T19:23:34.139821Z","close_reason":"Created feature-gated card widgets: ProfileCard, NewProfileCard, CardGrid, CardView. All compile with --features tui-cards.","dependencies":[{"issue_id":"bridle-s70","depends_on_id":"bridle-hue","type":"blocks","created_at":"2025-12-28T17:10:58.652871Z","created_by":"daemon"},{"issue_id":"bridle-s70","depends_on_id":"bridle-jb5","type":"blocks","created_at":"2025-12-28T17:10:58.728488Z","created_by":"daemon"}]}
{"id":"bridle-tel","title":"Add harness trait abstraction for testability","description":"Create a trait abstraction for harness config operations to enable unit testing of ProfileManager.\n\n- Abstract config path access\n- Abstract installation_status checks  \n- Create MockHarness for tests\n- Add test for switch_profile preserving edits","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T11:49:24.952265Z","updated_at":"2025-12-28T11:55:27.911433Z","closed_at":"2025-12-28T11:55:27.911433Z","close_reason":"Added HarnessConfig trait abstraction for testability. MockHarness enables unit testing. Added test proving switch_profile preserves edits."}
{"id":"bridle-un7","title":"OpenCode model extraction misses nested agent.general.model path","description":"extract_model_opencode() only checks top-level 'model' field but OpenCode configs commonly use nested 'agent.general.model' path.\n\n## Verification Steps\n\n1. Check the test profile config:\n   ```bash\n   cat ~/.config/bridle/profiles/opencode/test/opencode.jsonc | grep -A2 'agent'\n   # Should show agent.general.model path\n   ```\n\n2. Run profile show:\n   ```bash\n   cargo run -- profile show opencode test\n   ```\n\n3. **Before fix**: Model shows '(not set)' despite agent.general.model being configured\n\n4. **After fix**: Model should display the nested value, e.g.:\n   ```\n   Model: anthropic/claude-sonnet-4-5\n   ```\n\n5. Test both config styles work:\n   - Top-level: `{ \"model\": \"openai/gpt-4o\" }`\n   - Nested: `{ \"agent\": { \"general\": { \"model\": \"anthropic/claude-sonnet-4-5\" } } }`\n   \n   Priority: top-level should override nested (or document which takes precedence)\n\n## Code Location\n- File: src/config/manager.rs\n- Function: extract_model_opencode() (around line 389)","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-28T14:24:20.123931Z","updated_at":"2025-12-28T14:56:35.248422Z","closed_at":"2025-12-28T14:56:35.248422Z","close_reason":"Fixed: extract_model_opencode now checks nested agent.general.model path with top-level taking priority"}
{"id":"bridle-x1d","title":"Add JSON output to bridle profile show command","description":"## Parent Epic\nbridle-xgw: Nushell-friendly structured output for CLI display commands\n\n## Objective\nRefactor `bridle profile show \u003charness\u003e \u003cname\u003e` to support JSON output.\n\n## File to Modify: src/cli/profile.rs\n\n### Refactored show_profile()\n\n```rust\nuse crate::cli::output::{ResolvedFormat, output};\n\npub fn show_profile(harness: \u0026str, name: \u0026str, format: ResolvedFormat) -\u003e Result\u003c()\u003e {\n    let harness_kind = HarnessKind::from_id(harness)?;\n    let manager = ProfileManager::new(harness_kind);\n    let profile = manager.show(name)?;\n\n    output(\u0026profile, format, |p| print_profile_text(p));\n\n    Ok(())\n}\n\nfn print_profile_text(profile: \u0026ProfileInfo) {\n    // Existing detailed println! logic\n    println!(\"\\nProfile: {}\", profile.name);\n    println!(\"Harness: {}\", profile.harness_id);\n    println!(\"Active: {}\", if profile.is_active { \"yes\" } else { \"no\" });\n    println!(\"Path: {}\", profile.path.display());\n    \n    if let Some(theme) = \u0026profile.theme {\n        println!(\"Theme: {}\", theme);\n    }\n    if let Some(model) = \u0026profile.model {\n        println!(\"Model: {}\", model);\n    }\n    \n    print_resource_summary(\"MCP Servers\", \u0026profile.mcp_servers);\n    print_resource_summary(\"Skills\", \u0026profile.skills);\n    // ... etc\n}\n```\n\n### JSON Output Example\n\nSingle object (not array):\n\n```json\n{\n  \"name\": \"test\",\n  \"harness_id\": \"opencode\",\n  \"is_active\": true,\n  \"path\": \"/Users/d0/.config/bridle/profiles/opencode/test\",\n  \"mcp_servers\": [\n    {\"name\": \"filesystem\", \"enabled\": true},\n    {\"name\": \"github\", \"enabled\": true}\n  ],\n  \"skills\": {\n    \"items\": [\"rust\", \"python\", \"typescript\"],\n    \"directory_exists\": true\n  },\n  \"commands\": {\n    \"items\": [\"build\", \"test\", \"deploy\"],\n    \"directory_exists\": true\n  },\n  \"plugins\": {\n    \"items\": [],\n    \"directory_exists\": false\n  },\n  \"agents\": {\n    \"items\": [\"coder\", \"reviewer\"],\n    \"directory_exists\": true\n  },\n  \"rules_file\": \"RULES.md\",\n  \"theme\": \"dark\",\n  \"model\": \"claude-sonnet-4-20250514\",\n  \"extraction_errors\": []\n}\n```\n\n### Nushell Usage Examples\n\n```bash\n# Get specific field\nbridle profile show opencode test | from json | get model\n\n# List MCP servers\nbridle profile show claude default | from json | get mcp_servers | select name enabled\n\n# Check if profile has skills\nbridle profile show opencode test | from json | get skills.items | length\n\n# Compare two profiles\nlet a = (bridle profile show opencode test | from json)\nlet b = (bridle profile show opencode prod | from json)\n$a.mcp_servers | where name not-in ($b.mcp_servers | get name)\n```\n\n## Verification\n```bash\ncargo run -- profile show opencode test              # Text output\ncargo run -- -o json profile show opencode test      # JSON object\ncargo run -- -o json profile show opencode test | jq '.mcp_servers[].name'\n```\n\n## Dependencies\n- Depends on: bridle-dsh (Serialize on ProfileInfo)\n- Depends on: bridle-nfd (global --output flag)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:35:20.762269Z","updated_at":"2025-12-29T21:59:00.82512Z","closed_at":"2025-12-29T21:59:00.82512Z","close_reason":"Added JSON output to profile show using output() with ProfileInfo","dependencies":[{"issue_id":"bridle-x1d","depends_on_id":"bridle-nfd","type":"blocks","created_at":"2025-12-28T22:36:03.683496Z","created_by":"daemon"},{"issue_id":"bridle-x1d","depends_on_id":"bridle-dsh","type":"blocks","created_at":"2025-12-28T22:36:03.756894Z","created_by":"daemon"}]}
{"id":"bridle-xgw","title":"Nushell-friendly structured output for CLI display commands","description":"## Overview\n\nAdd structured output support (JSON) to bridle CLI display commands, with automatic Nushell detection for seamless shell integration.\n\n## Goals\n\n1. Enable scripting and piping of bridle output in Nushell and other shells\n2. Provide `--output` flag with `text`, `json`, and `auto` options\n3. Auto-detect Nushell via `NU_VERSION` env var and default to JSON\n4. Maintain backward compatibility (text output remains default in non-Nushell shells)\n\n## Design Decisions\n\n| Aspect | Decision | Rationale |\n|--------|----------|-----------|\n| Primary mechanism | `--output \u003cformat\u003e` global flag | Discoverable, explicit, standard pattern (kubectl, gh, docker) |\n| Formats | `text`, `json`, `auto` (default) | Auto gives magic UX while flags provide escape hatch |\n| Auto behavior | JSON if `NU_VERSION` set, else text | Nushell users get seamless experience |\n| Initial scope | `status`, `profile list`, `profile show` | Display/getter commands only |\n| JSON structure | Arrays for lists, objects for singles | Best UX for Nushell `from json` and jq |\n| NUON | Not supported | JSON is universal, NUON adds maintenance burden |\n\n## Architecture\n\n```\n┌─────────────────────────────────────────────────────────────┐\n│                      CLI Commands                           │\n│  (status.rs, profile.rs)                                   │\n└─────────────────┬───────────────────────────────────────────┘\n                  │ uses\n                  ▼\n┌─────────────────────────────────────────────────────────────┐\n│                   Output Module (NEW)                       │\n│  src/cli/output.rs                                         │\n│  - OutputFormat enum (Text, Json, Auto)                    │\n│  - Shell detection (NU_VERSION)                            │\n│  - output\u003cT: Serialize + TextDisplay\u003e() helper             │\n└─────────────────┬───────────────────────────────────────────┘\n                  │ serializes\n                  ▼\n┌─────────────────────────────────────────────────────────────┐\n│                    Data Structures                          │\n│  ProfileInfo, ResourceSummary, McpServerInfo, StatusInfo   │\n│  + #[derive(Serialize)]                                    │\n│  + impl TextDisplay for human-readable output              │\n└─────────────────────────────────────────────────────────────┘\n```\n\n## Usage Examples\n\n```bash\n# Default (auto) - text in bash, JSON in nushell\nbridle status\nbridle profile list claude\n\n# Explicit JSON (works anywhere)\nbridle status --output json\nbridle profile list claude -o json | jq '.[] | select(.is_active)'\n\n# Force text in Nushell\nbridle status --output text\n\n# Nushell integration\nbridle profile list claude | from json | where is_active == true\nbridle status | from json | get harnesses | where installed == true\n```\n\n## Success Criteria\n\n- [ ] `bridle status -o json` outputs valid JSON\n- [ ] `bridle profile list \u003charness\u003e -o json` outputs JSON array\n- [ ] `bridle profile show \u003charness\u003e \u003cname\u003e -o json` outputs JSON object\n- [ ] Running in Nushell auto-detects and outputs JSON\n- [ ] `--output text` overrides auto-detection\n- [ ] All existing text output unchanged when not using JSON\n- [ ] `cargo clippy -- -D warnings` passes\n- [ ] Quality gates pass","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-28T22:33:12.753912Z","updated_at":"2025-12-28T22:53:41.884234Z","closed_at":"2025-12-28T22:53:41.884234Z","close_reason":"Completed: Nushell-friendly JSON output implemented"}
{"id":"bridle-xgw.1","title":"Phase 1: Output infrastructure","description":"## Context\nAdd OutputFormat enum and global --output flag. No behavior change yet - just infrastructure.\n\n## Key Changes\n- `src/cli/output.rs` - NEW: OutputFormat enum, ResolvedFormat, output() helper\n- `src/cli/mod.rs` - Add `pub mod output;`\n- `src/main.rs` - Add global `--output` arg to Cli struct\n\n## Patterns to Follow\n- Use clap::ValueEnum for enum\n- std::io::IsTerminal for TTY detection (stable Rust 1.70+)\n- Check NU_VERSION env var for Nushell\n\n## Success Criteria\n- [ ] `cargo build` passes\n- [ ] `bridle --help` shows `-o, --output \u003cOUTPUT\u003e` flag\n- [ ] No clippy warnings\n\n## References\n- Full plan: `.beads/artifacts/bridle-xgw/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:43:52.922629Z","updated_at":"2025-12-28T22:47:29.52607Z","closed_at":"2025-12-28T22:47:29.526072Z","dependencies":[{"issue_id":"bridle-xgw.1","depends_on_id":"bridle-xgw","type":"parent-child","created_at":"2025-12-28T22:43:52.923146Z","created_by":"daemon"}]}
{"id":"bridle-xgw.2","title":"Phase 2: Add Serialize derives","description":"## Context\nEnable JSON serialization of all output types by adding Serialize derives.\n\n## Key Changes\n- `src/config/manager.rs` - Add #[derive(Serialize)] to McpServerInfo, ResourceSummary, ProfileInfo\n- `src/cli/status.rs` - Create StatusInfo and HarnessStatus structs with Serialize\n- Handle PathBuf serialization with custom serializer\n\n## Success Criteria\n- [ ] `cargo build` passes\n- [ ] `cargo test` passes\n- [ ] No clippy warnings\n\n## References\n- Full plan: `.beads/artifacts/bridle-xgw/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:43:57.06055Z","updated_at":"2025-12-28T22:49:57.023568Z","closed_at":"2025-12-28T22:49:57.023569Z","dependencies":[{"issue_id":"bridle-xgw.2","depends_on_id":"bridle-xgw","type":"parent-child","created_at":"2025-12-28T22:43:57.062614Z","created_by":"daemon"}]}
{"id":"bridle-xgw.3","title":"Phase 3: Refactor status command","description":"## Context\nRefactor status command to return data instead of printing directly.\n\n## Key Changes\n- `src/cli/status.rs` - Refactor display_status() -\u003e get_status() returning StatusInfo\n- `src/cli/status.rs` - Implement Display for StatusInfo\n- `src/main.rs` - Wire up output helper for status command\n\n## Success Criteria\n- [ ] `bridle status` shows same text output as before\n- [ ] `bridle status --output json` outputs valid JSON\n- [ ] `bridle status | jq .harnesses[0].id` works\n\n## References\n- Full plan: `.beads/artifacts/bridle-xgw/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:44:01.00457Z","updated_at":"2025-12-28T22:49:57.100844Z","closed_at":"2025-12-28T22:49:57.100847Z","dependencies":[{"issue_id":"bridle-xgw.3","depends_on_id":"bridle-xgw","type":"parent-child","created_at":"2025-12-28T22:44:01.006505Z","created_by":"daemon"}]}
{"id":"bridle-xgw.4","title":"Phase 4: Refactor profile commands","description":"## Context\nRefactor profile list and show commands to return data instead of printing.\n\n## Key Changes\n- `src/cli/profile.rs` - Create ProfileListItem, ProfileListOutput structs\n- `src/cli/profile.rs` - Refactor list_profiles() to return Result\u003cProfileListOutput\u003e\n- `src/cli/profile.rs` - Implement Display for ProfileInfo (move println logic)\n- `src/cli/profile.rs` - Refactor show_profile() to return Result\u003cProfileInfo\u003e\n- `src/main.rs` - Wire up output helper for profile commands\n\n## Success Criteria\n- [ ] `bridle profile list opencode` shows same text as before\n- [ ] `bridle profile list opencode --output json | jq '.'` works\n- [ ] `bridle profile show opencode test --output json | jq '.model'` works\n\n## References\n- Full plan: `.beads/artifacts/bridle-xgw/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:44:05.310546Z","updated_at":"2025-12-28T22:52:32.304785Z","closed_at":"2025-12-28T22:52:32.304788Z","dependencies":[{"issue_id":"bridle-xgw.4","depends_on_id":"bridle-xgw","type":"parent-child","created_at":"2025-12-28T22:44:05.312314Z","created_by":"daemon"}]}
{"id":"bridle-xgw.5","title":"Phase 5: Polish and testing","description":"## Context\nFinal verification, tests, and Nushell integration testing.\n\n## Key Changes\n- Add unit tests for OutputFormat::resolve()\n- Add serialization tests for StatusInfo\n- Manual verification in Nushell\n- Update help text with examples\n\n## Success Criteria\n- [ ] `cargo test` passes\n- [ ] Nushell: `bridle status | from json` works\n- [ ] Piped: `bridle status | cat` outputs JSON\n- [ ] TTY: `bridle status` outputs text\n\n## References\n- Full plan: `.beads/artifacts/bridle-xgw/plan.md`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T22:44:08.46993Z","updated_at":"2025-12-28T22:53:41.795432Z","closed_at":"2025-12-28T22:53:41.795434Z","dependencies":[{"issue_id":"bridle-xgw.5","depends_on_id":"bridle-xgw","type":"parent-child","created_at":"2025-12-28T22:44:08.472005Z","created_by":"daemon"}]}
{"id":"bridle-ypz","title":"Goose config.yaml parsing fails entirely with YAML error","description":"Running 'profile show goose test' produces 'ERROR: expected value at line 1 column 1' - the YAML parsing fails completely before any extraction can happen. The Goose config.yaml uses ALL_CAPS keys (GOOSE_MODEL, GOOSE_PROVIDER, etc.) which are valid YAML but may be tripping up the parser. This blocks all Goose profile functionality. Separate from the GOOSE_MODEL key name issue (bridle-ju4).\n\n## Verification Steps\n\n1. Ensure test profile exists:\n   ```bash\n   cargo run -- profile list goose\n   # Should show 'test' profile\n   ```\n\n2. Run the failing command:\n   ```bash\n   cargo run -- profile show goose test\n   ```\n\n3. **Before fix**: Shows 'ERROR: expected value at line 1 column 1'\n\n4. **After fix**: Should display profile info without YAML parse errors. At minimum:\n   - Path should show correctly\n   - No parse errors in output\n   - Model may still be '(not set)' until bridle-ju4 is fixed\n\n5. Verify with actual Goose config structure (ALL_CAPS keys):\n   ```yaml\n   GOOSE_PROVIDER: anthropic\n   GOOSE_MODEL: claude-sonnet-4-20250514\n   GOOSE_MODE: auto\n   extensions:\n     developer:\n       enabled: true\n   ```","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-28T14:37:43.291127Z","updated_at":"2025-12-28T14:49:13.858852Z","closed_at":"2025-12-28T14:49:13.858852Z","close_reason":"Fixed: parse_mcp_servers now detects YAML format by filename extension and filters Goose-internal extension types (builtin/platform)"}
{"id":"bridle-z15","title":"TUI Dashboard View: ProfileTable, DetailPane, Assembly","description":"# Dashboard View Implementation\n\n**Epic**: bridle-pm8 (TUI Redesign)\n**Phase**: 3 of 5\n**Depends on**: bridle-hue (Foundation), bridle-jb5 (Shared Widgets)\n\n## Objective\nImplement the three-pane dashboard view - the default TUI experience with always-visible profile details.\n\n## Layout Structure\n\n```\n┌─ Harness Tabs ──────────────────────────────────────────────┐  Length(3)\n│  [● Claude Code]  [+ OpenCode]  [- Goose]                   │\n├─ Profiles ───────────────────┬─ Details ────────────────────┤\n│ Percentage(40)               │ Percentage(60)               │\n│                              │                              │\n│ ● default    sonnet-4  3 MCP │ Profile: default             │\n│   test       sonnet-4  0 MCP │ ────────────────────────────│\n│                              │ Model: claude-sonnet-4       │\n│                              │ Theme: —                     │\n│                              │                              │  Fill(1)\n│                              │ MCP Servers (3)              │\n│                              │  ✓ filesystem                │\n│                              │  ✓ github                    │\n│                              │  ✗ postgres                  │\n│                              │                              │\n│                              │ Resources                    │\n│                              │  Skills: 5    Commands: 3    │\n│                              │  Plugins: —   Agents: —      │\n│                              │                              │\n│                              │ Path: ~/.config/bridle/...   │\n├─────────────────────────────┴──────────────────────────────┤\n│ ←→:harness  j/k:profile  Enter:switch  Space:details  ?    │  Length(1)\n└─────────────────────────────────────────────────────────────┘\n```\n\n## Widget 1: ProfileTable\n\n**File**: `src/tui/widgets/profile_table.rs`\n\n### Visual Design\n```\n│ ● default         claude-sonnet-4      3 MCP │\n│   test            claude-sonnet-4      0 MCP │\n│   production      gpt-4o               5 MCP │\n```\n\n### Columns\n| Column | Width | Content |\n|--------|-------|---------|\n| Active | 2 | `●` (green) or ` ` |\n| Name | Fill | Profile name |\n| Model | 20 | Truncated model name (last segment) |\n| MCP | 6 | `N MCP` count |\n\n### Implementation\n\n```rust\nuse ratatui::{\n    buffer::Buffer,\n    layout::{Constraint, Rect},\n    style::Modifier,\n    widgets::{Block, Borders, Row, Table, TableState, Widget, StatefulWidget},\n};\nuse crate::config::ProfileInfo;\nuse crate::tui::theme::Theme;\n\npub struct ProfileTable\u003c'a\u003e {\n    profiles: \u0026'a [ProfileInfo],\n    is_focused: bool,\n}\n\nimpl\u003c'a\u003e ProfileTable\u003c'a\u003e {\n    pub fn new(profiles: \u0026'a [ProfileInfo], is_focused: bool) -\u003e Self {\n        Self { profiles, is_focused }\n    }\n    \n    fn format_model(model: \u0026Option\u003cString\u003e) -\u003e String {\n        model.as_ref()\n            .map(|m| {\n                m.split('/').last().unwrap_or(m)\n                    .chars().take(18).collect::\u003cString\u003e()\n            })\n            .unwrap_or_else(|| \"—\".to_string())\n    }\n    \n    fn format_mcp_count(count: usize) -\u003e String {\n        if count == 0 {\n            \"—\".to_string()\n        } else {\n            format!(\"{} MCP\", count)\n        }\n    }\n}\n\nimpl StatefulWidget for ProfileTable\u003c'_\u003e {\n    type State = TableState;\n    \n    fn render(self, area: Rect, buf: \u0026mut Buffer, state: \u0026mut Self::State) {\n        let rows: Vec\u003cRow\u003e = self.profiles.iter().map(|p| {\n            let active = if p.is_active { \"●\" } else { \" \" };\n            let model = Self::format_model(\u0026p.model);\n            let mcp = Self::format_mcp_count(p.mcp_servers.len());\n            \n            let style = if p.is_active {\n                Theme::PROFILE_ACTIVE\n            } else {\n                Theme::PROFILE_NORMAL\n            };\n            \n            Row::new(vec![active.to_string(), p.name.clone(), model, mcp])\n                .style(style)\n        }).collect();\n        \n        let widths = [\n            Constraint::Length(2),      // Active indicator\n            Constraint::Fill(1),        // Name\n            Constraint::Length(20),     // Model\n            Constraint::Length(6),      // MCP count\n        ];\n        \n        let border_style = if self.is_focused {\n            Theme::BORDER_ACTIVE\n        } else {\n            Theme::BORDER_INACTIVE\n        };\n        \n        let table = Table::new(rows, widths)\n            .block(Block::default()\n                .title(\" Profiles \")\n                .borders(Borders::ALL)\n                .border_style(border_style))\n            .highlight_style(Theme::PROFILE_SELECTED)\n            .highlight_symbol(\"\u003e \");\n        \n        StatefulWidget::render(table, area, buf, state);\n    }\n}\n```\n\n## Widget 2: DetailPane\n\n**File**: `src/tui/widgets/detail_pane.rs`\n\n### Visual Design\n```\n┌─ Details ────────────────────┐\n│ Profile: default             │\n│ ────────────────────────────│\n│ Model: claude-sonnet-4       │\n│ Theme: dark                  │\n│                              │\n│ MCP Servers (3)              │\n│  ├─ ✓ filesystem             │\n│  ├─ ✓ github                 │\n│  └─ ✗ postgres               │\n│                              │\n│ Resources                    │\n│  Skills: 5    Commands: 3    │\n│  Plugins: 2   Agents: —      │\n│                              │\n│ Rules: AGENTS.md             │\n│                              │\n│ Path:                        │\n│  ~/.config/bridle/profiles/  │\n│  claude-code/default         │\n└──────────────────────────────┘\n```\n\n### Implementation\n\n```rust\nuse ratatui::{\n    buffer::Buffer,\n    layout::Rect,\n    text::{Line, Span},\n    widgets::{Block, Borders, Paragraph, Widget},\n};\nuse crate::config::ProfileInfo;\nuse crate::tui::theme::Theme;\n\npub struct DetailPane\u003c'a\u003e {\n    profile: Option\u003c\u0026'a ProfileInfo\u003e,\n    is_focused: bool,\n}\n\nimpl\u003c'a\u003e DetailPane\u003c'a\u003e {\n    pub fn new(profile: Option\u003c\u0026'a ProfileInfo\u003e, is_focused: bool) -\u003e Self {\n        Self { profile, is_focused }\n    }\n    \n    fn render_content(profile: \u0026ProfileInfo) -\u003e Vec\u003cLine\u003c'static\u003e\u003e {\n        let mut lines = Vec::new();\n        \n        // Header\n        lines.push(Line::styled(\n            format!(\"Profile: {}\", profile.name),\n            Theme::SECTION_HEADER\n        ));\n        lines.push(Line::raw(\"─\".repeat(30)));\n        lines.push(Line::raw(\"\"));\n        \n        // Model \u0026 Theme\n        lines.push(Line::from(vec![\n            Span::styled(\"Model: \", Theme::SECTION_HEADER),\n            Span::styled(\n                profile.model.as_deref().unwrap_or(\"—\"),\n                Theme::SECTION_CONTENT\n            ),\n        ]));\n        \n        if let Some(ref theme) = profile.theme {\n            lines.push(Line::from(vec![\n                Span::styled(\"Theme: \", Theme::SECTION_HEADER),\n                Span::styled(theme.clone(), Theme::SECTION_CONTENT),\n            ]));\n        }\n        lines.push(Line::raw(\"\"));\n        \n        // MCP Servers\n        lines.push(Line::styled(\n            format!(\"MCP Servers ({})\", profile.mcp_servers.len()),\n            Theme::SECTION_HEADER\n        ));\n        \n        let server_count = profile.mcp_servers.len();\n        for (i, server) in profile.mcp_servers.iter().enumerate() {\n            let branch = if i == server_count - 1 { \"└─\" } else { \"├─\" };\n            let (marker, style) = if server.enabled {\n                (\"✓\", Theme::MCP_ENABLED)\n            } else {\n                (\"✗\", Theme::MCP_DISABLED)\n            };\n            \n            lines.push(Line::from(vec![\n                Span::styled(format!(\" {} \", branch), Theme::TREE_BRANCH),\n                Span::styled(format!(\"{} {}\", marker, server.name), style),\n            ]));\n        }\n        \n        if profile.mcp_servers.is_empty() {\n            lines.push(Line::styled(\" (none)\", Theme::SECTION_CONTENT));\n        }\n        lines.push(Line::raw(\"\"));\n        \n        // Resources (2-column layout)\n        lines.push(Line::styled(\"Resources\", Theme::SECTION_HEADER));\n        \n        let skills = profile.skills.items.len();\n        let commands = profile.commands.items.len();\n        lines.push(Line::from(vec![\n            Span::raw(\" Skills: \"),\n            Span::styled(format!(\"{:\u003c4}\", skills), Theme::SECTION_CONTENT),\n            Span::raw(\" Commands: \"),\n            Span::styled(format!(\"{}\", commands), Theme::SECTION_CONTENT),\n        ]));\n        \n        if let Some(ref plugins) = profile.plugins {\n            let agents = profile.agents.as_ref().map(|a| a.items.len()).unwrap_or(0);\n            lines.push(Line::from(vec![\n                Span::raw(\" Plugins: \"),\n                Span::styled(format!(\"{:\u003c4}\", plugins.items.len()), Theme::SECTION_CONTENT),\n                Span::raw(\" Agents: \"),\n                Span::styled(\n                    if agents \u003e 0 { format!(\"{}\", agents) } else { \"—\".to_string() },\n                    Theme::SECTION_CONTENT\n                ),\n            ]));\n        }\n        lines.push(Line::raw(\"\"));\n        \n        // Rules file\n        if let Some(ref rules) = profile.rules_file {\n            if let Some(filename) = rules.file_name() {\n                lines.push(Line::from(vec![\n                    Span::styled(\"Rules: \", Theme::SECTION_HEADER),\n                    Span::styled(filename.to_string_lossy().to_string(), Theme::SECTION_CONTENT),\n                ]));\n                lines.push(Line::raw(\"\"));\n            }\n        }\n        \n        // Path (potentially wrapped)\n        lines.push(Line::styled(\"Path:\", Theme::SECTION_HEADER));\n        let path_str = profile.path.display().to_string();\n        // Split long paths across lines\n        for chunk in path_str.as_bytes().chunks(35) {\n            lines.push(Line::styled(\n                format!(\" {}\", String::from_utf8_lossy(chunk)),\n                Theme::SECTION_CONTENT\n            ));\n        }\n        \n        // Extraction errors (if any)\n        if !profile.extraction_errors.is_empty() {\n            lines.push(Line::raw(\"\"));\n            lines.push(Line::styled(\"⚠ Warnings\", Style::default().fg(Color::Yellow)));\n            for err in \u0026profile.extraction_errors {\n                lines.push(Line::styled(format!(\" {}\", err), Style::default().fg(Color::Yellow)));\n            }\n        }\n        \n        lines\n    }\n}\n\nimpl Widget for DetailPane\u003c'_\u003e {\n    fn render(self, area: Rect, buf: \u0026mut Buffer) {\n        let border_style = if self.is_focused {\n            Theme::BORDER_ACTIVE\n        } else {\n            Theme::BORDER_INACTIVE\n        };\n        \n        let block = Block::default()\n            .title(\" Details \")\n            .borders(Borders::ALL)\n            .border_style(border_style);\n        \n        let content = match self.profile {\n            Some(p) =\u003e Self::render_content(p),\n            None =\u003e vec![Line::styled(\n                \"Select a profile to view details\",\n                Theme::SECTION_CONTENT\n            )],\n        };\n        \n        Paragraph::new(content)\n            .block(block)\n            .render(area, buf);\n    }\n}\n```\n\n## Widget 3: DashboardView Assembly\n\n**File**: `src/tui/views/dashboard.rs`\n\n```rust\nuse ratatui::{\n    layout::{Constraint, Layout},\n    Frame,\n};\nuse crate::tui::{App, widgets::{HarnessTabs, ProfileTable, DetailPane, StatusBar}};\n\npub struct DashboardView;\n\nimpl DashboardView {\n    pub fn render(frame: \u0026mut Frame, app: \u0026mut App) {\n        let [tabs_area, main_area, status_area] = Layout::vertical([\n            Constraint::Length(3),\n            Constraint::Fill(1),\n            Constraint::Length(1),\n        ]).areas(frame.area());\n        \n        let [profiles_area, details_area] = Layout::horizontal([\n            Constraint::Percentage(40),\n            Constraint::Percentage(60),\n        ]).areas(main_area);\n        \n        // Render harness tabs\n        let tabs = HarnessTabs::new(\n            \u0026app.harnesses,\n            app.harness_state.selected().unwrap_or(0),\n            \u0026app.bridle_config,\n        );\n        frame.render_widget(tabs, tabs_area);\n        \n        // Render profile table\n        let table = ProfileTable::new(\u0026app.profiles, true);\n        frame.render_stateful_widget(table, profiles_area, \u0026mut app.profile_state);\n        \n        // Render detail pane\n        let selected_profile = app.profile_state.selected()\n            .and_then(|i| app.profiles.get(i));\n        let detail = DetailPane::new(selected_profile, false);\n        frame.render_widget(detail, details_area);\n        \n        // Render status bar\n        let status = StatusBar::new(StatusBar::dashboard_keybinds())\n            .message(app.status_message.as_deref());\n        frame.render_widget(status, status_area);\n    }\n}\n```\n\n## App Integration\n\nUpdate `src/tui/mod.rs` to use the new view:\n\n```rust\nfn ui(frame: \u0026mut Frame, app: \u0026mut App) {\n    match app.view_mode {\n        ViewMode::Dashboard =\u003e views::dashboard::DashboardView::render(frame, app),\n        #[cfg(feature = \"tui-cards\")]\n        ViewMode::Cards =\u003e views::cards::CardView::render(frame, app),\n    }\n    \n    // Help modal (shared)\n    if app.show_help {\n        render_help_modal(frame, frame.area(), app.view_mode);\n    }\n}\n```\n\n## Acceptance Criteria\n\n- [ ] ProfileTable shows name, model (truncated), MCP count columns\n- [ ] Selected profile highlighted with `\u003e` symbol\n- [ ] Active profile shows green `●` marker\n- [ ] DetailPane always shows selected profile's full info\n- [ ] Layout is responsive (40/60 split)\n- [ ] Empty state when no profiles exist\n- [ ] Keybinds work: j/k navigate, Enter switches, Space for future details mode\n\n## Testing\n\n```bash\ncargo run -- tui\n# Verify:\n# - Three-pane layout renders correctly\n# - j/k moves selection in profile table\n# - Detail pane updates as selection changes\n# - Enter switches to selected profile\n# - MCP servers show with ✓/✗ markers\n# - Resource counts display correctly\n```\n","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-28T17:09:08.471557Z","updated_at":"2025-12-28T19:20:34.289137Z","closed_at":"2025-12-28T19:20:34.289137Z","close_reason":"Created DashboardView assembly composing ProfileTable and DetailPane widgets. Widgets already had full implementation.","dependencies":[{"issue_id":"bridle-z15","depends_on_id":"bridle-hue","type":"blocks","created_at":"2025-12-28T17:10:58.501701Z","created_by":"daemon"},{"issue_id":"bridle-z15","depends_on_id":"bridle-jb5","type":"blocks","created_at":"2025-12-28T17:10:58.577375Z","created_by":"daemon"}]}
{"id":"bridle-zo9","title":"Phase 1: Global Profile Management","description":"Implement global profile management for Claude Code and OpenCode harnesses. Covers CLI foundation, profile CRUD, switching, edit/diff, and TUI.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-27T18:07:43.692162Z","updated_at":"2025-12-27T20:35:44.701638Z","closed_at":"2025-12-27T20:35:44.701638Z","close_reason":"Phase 1 Global Profile Management complete"}
{"id":"bridle-zo9.1","title":"Milestone 1: CLI Foundation","description":"Setup project structure, error handling, CLI skeleton, init/status commands, and harness adapter. Exit criteria: bridle status shows Claude Code/OpenCode installation status.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-27T18:07:50.903345Z","updated_at":"2025-12-27T20:07:35.119009Z","closed_at":"2025-12-27T20:07:35.119009Z","close_reason":"Milestone 1 complete - all children closed","dependencies":[{"issue_id":"bridle-zo9.1","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T18:07:50.904864Z","created_by":"daemon"}]}
{"id":"bridle-zo9.1.1","title":"Setup project structure and dependencies","description":"Create src/ directory structure per outline. Add all dependencies to Cargo.toml: get-harness, clap, serde, toml, serde_json, thiserror, color-eyre, dirs, chrono.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:06.604501Z","updated_at":"2025-12-27T18:29:30.179058Z","closed_at":"2025-12-27T18:29:30.179064Z","dependencies":[{"issue_id":"bridle-zo9.1.1","depends_on_id":"bridle-zo9.1","type":"parent-child","created_at":"2025-12-27T18:08:06.606153Z","created_by":"daemon"}]}
{"id":"bridle-zo9.1.2","title":"Implement Error enum with thiserror","description":"Create error.rs with Error enum covering: HarnessNotInstalled, ProfileNotFound, ProfileExists, NoActiveProfile, InvalidProfileName, NoConfigFound, and transparent wrappers for Io, Toml, Json, Harness errors.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:08.443321Z","updated_at":"2025-12-27T18:38:59.89279Z","closed_at":"2025-12-27T18:38:59.89279Z","close_reason":"Error enum implemented with all required variants - tests passing","dependencies":[{"issue_id":"bridle-zo9.1.2","depends_on_id":"bridle-zo9.1","type":"parent-child","created_at":"2025-12-27T18:08:08.44486Z","created_by":"daemon"}]}
{"id":"bridle-zo9.1.3","title":"Create CLI skeleton with clap derive","description":"Setup main.rs entry point and cli/ module with clap derive macros. Define top-level commands: status, init, profile (with subcommands), tui.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:10.092693Z","updated_at":"2025-12-27T18:45:31.030462Z","closed_at":"2025-12-27T18:45:31.030462Z","close_reason":"CLI skeleton implemented with all commands - tests passing","dependencies":[{"issue_id":"bridle-zo9.1.3","depends_on_id":"bridle-zo9.1","type":"parent-child","created_at":"2025-12-27T18:08:10.095114Z","created_by":"daemon"}]}
{"id":"bridle-zo9.1.4","title":"Implement bridle init command","description":"Create ~/.config/bridle/ directory structure and initialize config.toml with default BridleConfig.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:11.133721Z","updated_at":"2025-12-27T19:01:23.512556Z","closed_at":"2025-12-27T19:01:23.512556Z","close_reason":"Implemented - all requirements met, tests passing","dependencies":[{"issue_id":"bridle-zo9.1.4","depends_on_id":"bridle-zo9.1","type":"parent-child","created_at":"2025-12-27T18:08:11.136071Z","created_by":"daemon"}]}
{"id":"bridle-zo9.1.5","title":"Implement bridle status command","description":"Display installed harnesses via get-harness, show active profiles and their MCP servers. Format output for terminal readability.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:12.619572Z","updated_at":"2025-12-27T20:00:57.754155Z","closed_at":"2025-12-27T20:00:57.754155Z","close_reason":"Status command implemented - shows harness installation status and active profiles","dependencies":[{"issue_id":"bridle-zo9.1.5","depends_on_id":"bridle-zo9.1","type":"parent-child","created_at":"2025-12-27T18:08:12.621409Z","created_by":"daemon"}]}
{"id":"bridle-zo9.1.6","title":"Create harness adapter module","description":"Create harness/ module with adapter.rs wrapping get-harness crate and display.rs for extracting display info from configs.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:13.924908Z","updated_at":"2025-12-27T20:04:15.973816Z","closed_at":"2025-12-27T20:04:15.973816Z","close_reason":"Harness adapter module implemented - adapter.rs wraps get-harness, display.rs provides DisplayInfo","dependencies":[{"issue_id":"bridle-zo9.1.6","depends_on_id":"bridle-zo9.1","type":"parent-child","created_at":"2025-12-27T18:08:13.927405Z","created_by":"daemon"}]}
{"id":"bridle-zo9.10","title":"TUI Foundation - ratatui scaffold","description":"## Context\nBasic TUI scaffold using ratatui. Placeholder for future full TUI implementation.\n\n## Key Changes\n- `Cargo.toml` - Add ratatui = \"0.29\", crossterm = \"0.28\"\n- `src/tui/mod.rs` - App struct with run(), draw(), handle_events()\n- `src/cli/tui.rs` - Wire up run_tui() to launch app\n\n## Patterns to Follow\n- Standard ratatui app loop pattern\n- crossterm for terminal events\n- Placeholder UI with quit instruction\n\n## Success Criteria\n- [ ] cargo build \u0026\u0026 cargo clippy -- -D warnings\n- [ ] bridle tui launches terminal UI\n- [ ] 'q' exits cleanly\n- [ ] Terminal restored after exit\n\n## References\n- Full plan: .beads/artifacts/bridle-zo9/plan.md (Phase 5 section)\n- ratatui docs: https://ratatui.rs/","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-27T19:34:57.310497Z","updated_at":"2025-12-27T20:35:37.015589Z","closed_at":"2025-12-27T20:35:37.015589Z","close_reason":"Implemented as part of main features","dependencies":[{"issue_id":"bridle-zo9.10","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T19:34:57.312128Z","created_by":"daemon"}]}
{"id":"bridle-zo9.2","title":"Milestone 2: Profile CRUD","description":"Implement BridleConfig, profile name validation, ProfileManager methods for list/create/show/delete, and config info extraction. Exit criteria: Can create, list, show, delete profiles via CLI.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-27T18:07:52.161975Z","updated_at":"2025-12-27T20:35:43.688725Z","closed_at":"2025-12-27T20:35:43.688725Z","close_reason":"All tasks completed","dependencies":[{"issue_id":"bridle-zo9.2","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T18:07:52.163709Z","created_by":"daemon"}]}
{"id":"bridle-zo9.2.1","title":"Implement BridleConfig load/save","description":"Create config/bridle.rs with BridleConfig and BridleSettings structs. Implement load from and save to ~/.config/bridle/config.toml.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:15.236627Z","updated_at":"2025-12-27T20:07:35.203129Z","closed_at":"2025-12-27T20:07:35.203129Z","close_reason":"BridleConfig load/save implemented in config/bridle.rs","dependencies":[{"issue_id":"bridle-zo9.2.1","depends_on_id":"bridle-zo9.2","type":"parent-child","created_at":"2025-12-27T18:08:15.238484Z","created_by":"daemon"}]}
{"id":"bridle-zo9.2.2","title":"Add profile name validation and normalization","description":"Validate profile names: alphanumeric + hyphens only. Normalize to lowercase (Work-Profile -\u003e work-profile). Return InvalidProfileName error for invalid input.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:16.678524Z","updated_at":"2025-12-27T20:07:35.283469Z","closed_at":"2025-12-27T20:07:35.283469Z","close_reason":"Profile name validation implemented in config/profile_name.rs with full test suite","dependencies":[{"issue_id":"bridle-zo9.2.2","depends_on_id":"bridle-zo9.2","type":"parent-child","created_at":"2025-12-27T18:08:16.680352Z","created_by":"daemon"}]}
{"id":"bridle-zo9.2.3","title":"Implement ProfileManager::list()","description":"Enumerate profile directories under ~/.config/bridle/profiles/{harness}/. Return list of profile names for a given harness or all harnesses.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:17.916333Z","updated_at":"2025-12-27T20:07:35.368128Z","closed_at":"2025-12-27T20:07:35.368128Z","close_reason":"ProfileManager::list_profiles() implemented in config/manager.rs","dependencies":[{"issue_id":"bridle-zo9.2.3","depends_on_id":"bridle-zo9.2","type":"parent-child","created_at":"2025-12-27T18:08:17.918246Z","created_by":"daemon"}]}
{"id":"bridle-zo9.2.4","title":"Implement ProfileManager::create_from_current()","description":"Copy current harness config files to new profile directory. For Claude Code: copy both settings.json and claude.json. For OpenCode: copy opencode.json.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:19.402248Z","updated_at":"2025-12-27T20:19:21.440039Z","closed_at":"2025-12-27T20:19:21.440039Z","close_reason":"Implemented create_from_current() - copies harness config files to profile directory with --from-current CLI flag","dependencies":[{"issue_id":"bridle-zo9.2.4","depends_on_id":"bridle-zo9.2","type":"parent-child","created_at":"2025-12-27T18:08:19.404407Z","created_by":"daemon"}]}
{"id":"bridle-zo9.2.5","title":"Implement ProfileManager::create_empty()","description":"Create empty profile directory structure for manual population. Used with --empty flag.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:20.437276Z","updated_at":"2025-12-27T20:07:35.453889Z","closed_at":"2025-12-27T20:07:35.453889Z","close_reason":"ProfileManager::create_profile() implemented - creates empty profile directory","dependencies":[{"issue_id":"bridle-zo9.2.5","depends_on_id":"bridle-zo9.2","type":"parent-child","created_at":"2025-12-27T18:08:20.438962Z","created_by":"daemon"}]}
{"id":"bridle-zo9.2.6","title":"Implement ProfileManager::show()","description":"Read and display profile content including raw JSON and extracted info (MCPs, key settings). Format for terminal output.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:21.713851Z","updated_at":"2025-12-27T20:35:36.725931Z","closed_at":"2025-12-27T20:35:36.725931Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.2.6","depends_on_id":"bridle-zo9.2","type":"parent-child","created_at":"2025-12-27T18:08:21.715785Z","created_by":"daemon"}]}
{"id":"bridle-zo9.2.7","title":"Implement ProfileManager::delete()","description":"Remove profile directory after user confirmation. Prevent deletion of active profile without force flag.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:22.804622Z","updated_at":"2025-12-27T20:07:35.541185Z","closed_at":"2025-12-27T20:07:35.541185Z","close_reason":"ProfileManager::delete_profile() implemented in config/manager.rs","dependencies":[{"issue_id":"bridle-zo9.2.7","depends_on_id":"bridle-zo9.2","type":"parent-child","created_at":"2025-12-27T18:08:22.806528Z","created_by":"daemon"}]}
{"id":"bridle-zo9.2.8","title":"Extract display info from config JSON","description":"Parse config JSON to extract MCP server names and key settings for ProfileInfo struct. Handle both Claude Code and OpenCode config formats.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:08:24.068642Z","updated_at":"2025-12-27T20:35:36.727685Z","closed_at":"2025-12-27T20:35:36.727685Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.2.8","depends_on_id":"bridle-zo9.2","type":"parent-child","created_at":"2025-12-27T18:08:24.070467Z","created_by":"daemon"}]}
{"id":"bridle-zo9.3","title":"Milestone 3: Profile Switching","description":"Implement backup, atomic switch, active profile tracking, and switch command. Exit criteria: Can switch profiles; old config backed up; status shows active profile.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-27T18:07:53.146725Z","updated_at":"2025-12-27T20:35:43.690246Z","closed_at":"2025-12-27T20:35:43.690246Z","close_reason":"All tasks completed","dependencies":[{"issue_id":"bridle-zo9.3","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T18:07:53.148661Z","created_by":"daemon"}]}
{"id":"bridle-zo9.3.1","title":"Implement ProfileManager::backup_current()","description":"Create timestamped backup in ~/.config/bridle/backups/{harness}/{timestamp}/. Copy all config files. Backups are never auto-pruned.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:09:08.808704Z","updated_at":"2025-12-27T20:35:36.728557Z","closed_at":"2025-12-27T20:35:36.728557Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.3.1","depends_on_id":"bridle-zo9.3","type":"parent-child","created_at":"2025-12-27T18:09:08.810555Z","created_by":"daemon"}]}
{"id":"bridle-zo9.3.2","title":"Implement ProfileManager::switch() with atomic copy","description":"Switch profile using atomic operations: write to temp file, then rename. Ensures config is never in partial state.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:09:10.388022Z","updated_at":"2025-12-27T20:35:36.729324Z","closed_at":"2025-12-27T20:35:36.729324Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.3.2","depends_on_id":"bridle-zo9.3","type":"parent-child","created_at":"2025-12-27T18:09:10.389916Z","created_by":"daemon"}]}
{"id":"bridle-zo9.3.3","title":"Add active profile tracking in config.toml","description":"Update BridleConfig.active HashMap when switching profiles. Persist to config.toml immediately after successful switch.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:09:11.804299Z","updated_at":"2025-12-27T20:35:36.730372Z","closed_at":"2025-12-27T20:35:36.730372Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.3.3","depends_on_id":"bridle-zo9.3","type":"parent-child","created_at":"2025-12-27T18:09:11.806242Z","created_by":"daemon"}]}
{"id":"bridle-zo9.3.4","title":"Implement bridle profile switch command","description":"Wire up CLI command to backup current, copy profile to harness location, update active tracking. Show confirmation message.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-27T18:09:13.371964Z","updated_at":"2025-12-27T20:35:36.731232Z","closed_at":"2025-12-27T20:35:36.731232Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.3.4","depends_on_id":"bridle-zo9.3","type":"parent-child","created_at":"2025-12-27T18:09:13.37402Z","created_by":"daemon"}]}
{"id":"bridle-zo9.4","title":"Milestone 4: Edit and Diff","description":"Implement profile edit and diff commands. Exit criteria: Can edit profiles in editor; can see differences between profiles.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-27T18:07:53.993838Z","updated_at":"2025-12-27T20:35:43.691271Z","closed_at":"2025-12-27T20:35:43.691271Z","close_reason":"All tasks completed","dependencies":[{"issue_id":"bridle-zo9.4","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T18:07:53.995846Z","created_by":"daemon"}]}
{"id":"bridle-zo9.4.1","title":"Implement bridle profile edit command","description":"Spawn $EDITOR on profile directory. Handle missing EDITOR env var gracefully with helpful error message.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:09:14.812646Z","updated_at":"2025-12-27T20:35:36.73468Z","closed_at":"2025-12-27T20:35:36.73468Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.4.1","depends_on_id":"bridle-zo9.4","type":"parent-child","created_at":"2025-12-27T18:09:14.815257Z","created_by":"daemon"}]}
{"id":"bridle-zo9.4.2","title":"Implement bridle profile diff command","description":"Diff two profiles, or profile vs current config. Second argument defaults to current if omitted.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:09:16.160844Z","updated_at":"2025-12-27T20:35:36.735643Z","closed_at":"2025-12-27T20:35:36.735643Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.4.2","depends_on_id":"bridle-zo9.4","type":"parent-child","created_at":"2025-12-27T18:09:16.163027Z","created_by":"daemon"}]}
{"id":"bridle-zo9.4.3","title":"Add diff functionality using diff CLI or similar crate","description":"Use system diff command or similar crate for computing differences. Show colored unified diff output.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:09:17.635694Z","updated_at":"2025-12-27T20:35:36.736577Z","closed_at":"2025-12-27T20:35:36.736577Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.4.3","depends_on_id":"bridle-zo9.4","type":"parent-child","created_at":"2025-12-27T18:09:17.637578Z","created_by":"daemon"}]}
{"id":"bridle-zo9.5","title":"Milestone 5: TUI","description":"Build interactive TUI with ratatui for profile management. Exit criteria: Full TUI workflow for profile management.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-27T18:07:54.828243Z","updated_at":"2025-12-27T20:35:43.692277Z","closed_at":"2025-12-27T20:35:43.692277Z","close_reason":"All tasks completed","dependencies":[{"issue_id":"bridle-zo9.5","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T18:07:54.830008Z","created_by":"daemon"}]}
{"id":"bridle-zo9.5.1","title":"Setup ratatui and crossterm with panic restore","description":"Initialize terminal with crossterm backend. Install panic hook to restore terminal state on crash.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:09:19.111281Z","updated_at":"2025-12-27T20:35:36.737451Z","closed_at":"2025-12-27T20:35:36.737451Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.5.1","depends_on_id":"bridle-zo9.5","type":"parent-child","created_at":"2025-12-27T18:09:19.113227Z","created_by":"daemon"}]}
{"id":"bridle-zo9.5.2","title":"Create App state struct with TEA pattern","description":"Implement The Elm Architecture: App struct with state, update() for messages, view() for rendering.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:09:20.638285Z","updated_at":"2025-12-27T20:35:36.738276Z","closed_at":"2025-12-27T20:35:36.738276Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.5.2","depends_on_id":"bridle-zo9.5","type":"parent-child","created_at":"2025-12-27T18:09:20.641487Z","created_by":"daemon"}]}
{"id":"bridle-zo9.5.3","title":"Implement harness list pane","description":"Left pane showing installed harnesses. Highlight selected harness. Show installation status indicator.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:09:21.866057Z","updated_at":"2025-12-27T20:35:36.739145Z","closed_at":"2025-12-27T20:35:36.739145Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.5.3","depends_on_id":"bridle-zo9.5","type":"parent-child","created_at":"2025-12-27T18:09:21.86845Z","created_by":"daemon"}]}
{"id":"bridle-zo9.5.4","title":"Implement profile list pane with MCP info","description":"Right pane showing profiles for selected harness. Display extracted MCP server names. Highlight active profile.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:09:23.1576Z","updated_at":"2025-12-27T20:35:36.739976Z","closed_at":"2025-12-27T20:35:36.739976Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.5.4","depends_on_id":"bridle-zo9.5","type":"parent-child","created_at":"2025-12-27T18:09:23.15929Z","created_by":"daemon"}]}
{"id":"bridle-zo9.5.5","title":"Add keybindings for navigation and actions","description":"Implement: j/k navigate, Enter switch, n create, d delete, e edit, q quit. Show keybinding hints in UI.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:09:24.853136Z","updated_at":"2025-12-27T20:35:36.740769Z","closed_at":"2025-12-27T20:35:36.740769Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.5.5","depends_on_id":"bridle-zo9.5","type":"parent-child","created_at":"2025-12-27T18:09:24.854882Z","created_by":"daemon"}]}
{"id":"bridle-zo9.5.6","title":"Implement status bar with messages","description":"Bottom bar showing current action, success/error messages, and contextual help. Auto-clear after timeout.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T18:09:26.163703Z","updated_at":"2025-12-27T20:35:36.741551Z","closed_at":"2025-12-27T20:35:36.741551Z","close_reason":"Implemented","dependencies":[{"issue_id":"bridle-zo9.5.6","depends_on_id":"bridle-zo9.5","type":"parent-child","created_at":"2025-12-27T18:09:26.165524Z","created_by":"daemon"}]}
{"id":"bridle-zo9.6","title":"CLI Foundation - status command and platform switch","description":"## Context\nFirst phase of profile management. Establishes foundation by adding status command and switching from dirs crate to get_harness::platform for cross-platform consistency.\n\n## Key Changes\n- `src/config/bridle.rs` - Replace dirs::config_dir() with get_harness::platform::config_dir()\n- `src/config/bridle.rs` - Change active_profile: Option\u003cString\u003e to active: HashMap\u003cString, String\u003e\n- `src/cli/status.rs` - Implement display_status() showing installed harnesses and active profiles\n- `Cargo.toml` - Remove dirs dependency\n\n## Patterns to Follow\n- CLI command pattern from src/cli/init.rs:5-45 (return (), use eprintln!/return for errors)\n- Config methods from src/config/bridle.rs (load/save pattern)\n\n## Success Criteria\n- [ ] cargo build passes\n- [ ] cargo clippy -- -D warnings passes\n- [ ] bridle status shows installed harnesses\n- [ ] Config uses new active HashMap format\n\n## References\n- Full plan: .beads/artifacts/bridle-zo9/plan.md\n- Research: .beads/artifacts/bridle-zo9/research.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:34:40.142993Z","updated_at":"2025-12-27T19:40:22.072584Z","closed_at":"2025-12-27T19:40:22.072587Z","dependencies":[{"issue_id":"bridle-zo9.6","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T19:34:40.143501Z","created_by":"daemon"}]}
{"id":"bridle-zo9.7","title":"Profile CRUD - ProfileName type and create/list/show/delete","description":"## Context\nCore profile operations. Implements validated ProfileName type and CRUD operations on ProfileManager.\n\n## Key Changes\n- `src/config/profile_name.rs` (new) - ProfileName newtype with TryFrom\u003c\u0026str\u003e, validation rules\n- `src/config/manager.rs` - Add list_profiles(), create_profile(), delete_profile(), show_profile(), profile_exists()\n- `src/cli/commands.rs` - Update ProfileCommands to use \u003cHARNESS\u003e \u003cNAME\u003e pattern\n- `src/cli/profile.rs` - Implement all CRUD command handlers\n- `src/config/mod.rs` - Export profile_name module\n\n## Patterns to Follow\n- Validation type pattern: TryFrom\u003c\u0026str\u003e with custom error enum\n- ProfileManager methods take \u0026Harness, return crate::error::Result\u003cT\u003e\n- harness_id() helper: claude-code, opencode, goose\n\n## Success Criteria\n- [ ] cargo build \u0026\u0026 cargo clippy -- -D warnings\n- [ ] Unit tests for ProfileName validation pass\n- [ ] bridle profile list claude-code works\n- [ ] bridle profile create/show/delete work\n- [ ] Invalid profile names rejected with clear error\n\n## References\n- Full plan: .beads/artifacts/bridle-zo9/plan.md (Phase 2 section)\n- Research: .beads/artifacts/bridle-zo9/research.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:34:46.282248Z","updated_at":"2025-12-27T19:52:56.341409Z","closed_at":"2025-12-27T19:52:56.341409Z","close_reason":"Closed","dependencies":[{"issue_id":"bridle-zo9.7","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T19:34:46.285377Z","created_by":"daemon"}]}
{"id":"bridle-zo9.8","title":"Profile Switching - atomic switch with backup","description":"## Context\nImplements atomic profile switching with backup-before-apply. Most critical phase for data safety.\n\n## Key Changes\n- `src/config/manager.rs` - Add backups_dir(), create_backup(), switch_profile()\n- `src/cli/profile.rs` - Implement switch_profile() handler\n- `Cargo.toml` - Add chrono = \"0.4\" for timestamp formatting\n\n## Algorithm (switch_profile)\n1. Validate profile exists\n2. Backup current config to backups/\u003charness\u003e/\u003ctimestamp\u003e/\n3. Create staging dir in same parent as target\n4. Copy profile -\u003e staging\n5. Remove target, rename staging -\u003e target\n6. Update BridleConfig.active, save\n\n## Patterns to Follow\n- Backup naming: YYYY-MM-DDTHH-MM-SS format\n- Staging dir: .bridle-staging-\u003cpid\u003e-\u003ctimestamp\u003e\n- Always backup before any destructive operation\n\n## Success Criteria\n- [ ] cargo build \u0026\u0026 cargo clippy -- -D warnings\n- [ ] bridle profile switch claude-code work creates backup\n- [ ] Backup appears in ~/.config/bridle/backups/claude-code/\n- [ ] Active profile updated in config.toml\n- [ ] bridle status shows new active profile\n\n## References\n- Full plan: .beads/artifacts/bridle-zo9/plan.md (Phase 3 section)\n- Research: .beads/artifacts/bridle-zo9/research.md","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-27T19:34:51.106095Z","updated_at":"2025-12-27T20:35:37.013571Z","closed_at":"2025-12-27T20:35:37.013571Z","close_reason":"Implemented as part of main features","dependencies":[{"issue_id":"bridle-zo9.8","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T19:34:51.107879Z","created_by":"daemon"}]}
{"id":"bridle-zo9.9","title":"Edit/Diff - EDITOR integration and profile comparison","description":"## Context\nQuality-of-life features for editing profiles and comparing them.\n\n## Key Changes\n- `src/cli/commands.rs` - Add Diff and Edit variants to ProfileCommands\n- `src/cli/profile.rs` - Implement diff_profiles() using system diff -r -u\n- `src/cli/profile.rs` - Implement edit_profile() using $EDITOR\n\n## Patterns to Follow\n- Use std::process::Command for external tools\n- Fall back to vim if $EDITOR not set\n- diff -r -u for recursive unified diff\n\n## Success Criteria\n- [ ] cargo build \u0026\u0026 cargo clippy -- -D warnings\n- [ ] bridle profile diff claude-code work default shows differences\n- [ ] bridle profile edit claude-code work opens $EDITOR\n- [ ] Changes in editor persist\n\n## References\n- Full plan: .beads/artifacts/bridle-zo9/plan.md (Phase 4 section)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-27T19:34:54.311106Z","updated_at":"2025-12-27T20:35:37.014679Z","closed_at":"2025-12-27T20:35:37.014679Z","close_reason":"Implemented as part of main features","dependencies":[{"issue_id":"bridle-zo9.9","depends_on_id":"bridle-zo9","type":"parent-child","created_at":"2025-12-27T19:34:54.312861Z","created_by":"daemon"}]}
